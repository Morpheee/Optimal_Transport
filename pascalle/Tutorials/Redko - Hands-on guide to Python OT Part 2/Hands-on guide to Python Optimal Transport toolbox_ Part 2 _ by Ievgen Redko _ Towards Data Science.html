<!DOCTYPE html>
<!-- saved from url=(0101)https://towardsdatascience.com/hands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062 -->
<html lang="en" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/branch-latest.min.js"></script><script async="" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/analytics.js"></script><script defer="" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/16180790160.js"></script><title>Hands-on guide to Python Optimal Transport toolbox: Part 2 | by Ievgen Redko | Towards Data Science</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-08-26T14:18:21.897Z"><meta data-rh="true" name="title" content="Hands-on guide to Python Optimal Transport toolbox: Part 2 | by Ievgen Redko | Towards Data Science"><meta data-rh="true" property="og:title" content="Hands-on guide to Python Optimal Transport toolbox: Part 2"><meta data-rh="true" property="twitter:title" content="Hands-on guide to Python Optimal Transport toolbox: Part 2"><meta data-rh="true" name="twitter:site" content="@TDataScience"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/783029a1f062"><meta data-rh="true" property="al:android:url" content="medium://p/783029a1f062"><meta data-rh="true" property="al:ios:url" content="medium://p/783029a1f062"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="As a follow-up of my previous introductory article on optimal transport and a first part of this guide provided by Aurelie Boisbunon here, I will present below how you can solve different tasks with…"><meta data-rh="true" property="og:description" content="Color transfer, Image editing and Automatic Translation"><meta data-rh="true" property="twitter:description" content="Color transfer, Image editing and Automatic Translation"><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/hands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062"><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/hands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062"><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*DsDDxjH-J4v_Q8tTM1BXtw.png"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*DsDDxjH-J4v_Q8tTM1BXtw.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://ievred.medium.com"><meta data-rh="true" name="author" content="Ievgen Redko"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="8 min read"><meta data-rh="true" name="parsely-post-id" content="783029a1f062"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://towardsdatascience.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/unbound.css"><link data-rh="true" rel="author" href="https://ievred.medium.com/"><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/hands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/783029a1f062"><link rel="preload" href="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="522" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-moz-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-webkit-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-moz-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-webkit-keyframes k3{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k3{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k3{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k4{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k4{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k4{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{margin-bottom:36px}.v{width:100%}.w{overflow-x:scroll}.x{white-space:nowrap}.y{scrollbar-width:none}.z{-ms-overflow-style:none}.ab::-webkit-scrollbar{display:none}.ac{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ae{min-height:184px}.ah{flex-direction:column}.ai{background-color:#355876}.aj{display:none}.al{border-bottom:none}.am{position:relative}.an{z-index:500}.at{max-width:1192px}.au{min-width:0}.av{height:62px}.aw{flex-direction:row}.ax{flex:1 0 auto}.ay{margin-left:0px}.az{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.ba{font-size:14px}.bb{line-height:20px}.bc{color:rgba(197, 210, 225, 1)}.bd{color:rgba(233, 241, 250, 1)}.be{fill:rgba(233, 241, 250, 1)}.bf{font-size:inherit}.bg{border:inherit}.bh{font-family:inherit}.bi{letter-spacing:inherit}.bj{font-weight:inherit}.bk{padding:0}.bl{margin:0}.bp:disabled{cursor:default}.bq:disabled{color:rgba(163, 208, 162, 0.5)}.br:disabled{fill:rgba(163, 208, 162, 0.5)}.bs{min-height:115px}.bt{justify-content:space-between}.bz{align-items:flex-start}.ca{margin-bottom:0px}.cb{margin-top:-32px}.cc{flex-wrap:wrap}.cf{margin-top:32px}.cg{margin-right:24px}.ci{height:35px}.cj{width:112px}.ck{flex:0 0 auto}.cl{justify-self:flex-end}.cm{margin-right:12px}.cn{height:32px}.co{overflow:visible}.cp{border-radius:1000px}.cq{background-color:rgba(53, 88, 118, 0.8)}.cr{fill:rgba(197, 210, 225, 1)}.cs{color:inherit}.ct{fill:rgba(117, 117, 117, 1)}.cu{outline:none}.cv{padding:4px}.cw{margin-left:8px}.cx{margin-right:10px}.cy{display:inline-block}.cz{border:none}.da{font:inherit}.db{font-size:16px}.dc{opacity:0}.dd{background-color:transparent}.de::placeholder{color:rgba(197, 210, 225, 1)}.df{padding:0px}.dg{width:0px}.dh{transition:width 140ms ease-in, padding 140ms ease-in}.di{fill:inherit}.dl:disabled{color:rgba(197, 210, 225, 1)}.dm:disabled{fill:rgba(197, 210, 225, 1)}.dn{fill:rgba(251, 255, 255, 1)}.do{padding-top:1px}.dp{height:70px}.dr{line-height:24px}.ds:before{margin-bottom:-10px}.dt:before{content:""}.du:before{display:table}.dv:before{border-collapse:collapse}.dw:after{margin-top:-6px}.dx:after{content:""}.dy:after{display:table}.dz:after{border-collapse:collapse}.ea{color:rgba(117, 117, 117, 1)}.eb{margin-right:32px}.ec{margin-bottom:-16px}.ed{margin-top:-14px}.ee{color:rgba(255, 255, 255, 1)}.ef{padding:7px 16px 9px}.eg{fill:rgba(255, 255, 255, 1)}.eh{background:rgba(102, 138, 170, 1)}.ei{border-color:rgba(102, 138, 170, 1)}.el:disabled{cursor:inherit}.em:disabled{opacity:0.3}.en:disabled:hover{background:rgba(102, 138, 170, 1)}.eo:disabled:hover{border-color:rgba(102, 138, 170, 1)}.ep{border-radius:99em}.eq{border-width:1px}.er{border-style:solid}.es{box-sizing:border-box}.et{text-decoration:none}.eu{display:inline-flex}.ex:disabled{color:rgba(117, 117, 117, 1)}.ey:disabled{fill:rgba(117, 117, 117, 1)}.ez{margin-left:12px}.fa{margin:0 12px}.fb{position:absolute}.fc{right:24px}.fd{margin:0px}.fe{border:0px}.ff{cursor:pointer}.fg{stroke:rgba(117, 117, 117, 1)}.fj{border-top:none}.fk{left:0}.fl{position:fixed}.fm{right:0}.fn{top:0}.fo{visibility:hidden}.fq{height:60px}.ft{color:rgba(102, 138, 170, 1)}.fu{fill:rgba(102, 138, 170, 1)}.fx{padding-left:24px}.fy{padding-right:24px}.fz{margin-left:auto}.ga{margin-right:auto}.gb{max-width:728px}.gc{background:rgba(255, 255, 255, 1)}.gd{border:1px solid rgba(230, 230, 230, 1)}.ge{border-radius:4px}.gf{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{top:calc(100vh + 100px)}.gj{bottom:calc(100vh + 100px)}.gk{width:10px}.gl{pointer-events:none}.gm{word-break:break-word}.gn{word-wrap:break-word}.go:after{display:block}.gp:after{clear:both}.gq{max-width:680px}.gr{line-height:1.23}.gs{letter-spacing:0}.gt{font-style:normal}.gu{font-weight:700}.hp{margin-bottom:-0.27em}.hq{color:rgba(41, 41, 41, 1)}.hr{line-height:1.394}.ih{margin-bottom:-0.42em}.il{border-radius:50%}.im{height:28px}.in{width:28px}.io{fill:rgba(61, 61, 61, 1)}.ip{margin-top:-2px}.iq{padding-left:4px}.ir{margin:0 4px}.is{margin:0 7px}.it{align-items:flex-end}.jc{padding-right:8px}.jd{margin-right:8px}.je{margin-right:-4px}.jh{line-height:1.58}.ji{letter-spacing:-0.004em}.jj{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.jx{margin-top:24px}.jy{margin-bottom:-0.46em}.jz{text-decoration:underline}.kk{padding:20px}.kl{background:rgba(242, 242, 242, 1)}.km{overflow-x:auto}.kn{line-height:1.18}.ko{letter-spacing:-0.022em}.kp{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.kq{margin-top:-0.09em}.kr{margin-bottom:-0.09em}.ks{white-space:pre-wrap}.kt{font-weight:500}.lg{margin-bottom:-0.31em}.lm{max-width:1079px}.ln{clear:both}.lo{border-width:2px}.lp{border-color:rgba(255, 255, 255, 1)}.lq{float:left}.lr{margin-left:-150px}.ls{margin-right:30px}.lt{width:75%}.lu{padding-bottom:10px}.lz{margin-bottom:16px}.mb{cursor:zoom-in}.mc{z-index:auto}.me{transition:opacity 100ms 400ms}.mf{height:100%}.mg{overflow:hidden}.mh{will-change:transform}.mi{transform:translateZ(0)}.mj{margin:auto}.mk{background-color:rgba(242, 242, 242, 1)}.ml{padding-bottom:33.64226135310473%}.mm{height:0}.mn{filter:blur(20px)}.mo{transform:scale(1.1)}.mp{visibility:visible}.mq{font-style:italic}.mr{max-width:3840px}.ms{padding-bottom:46.875%}.mt{padding-bottom:75%}.mu{font-style:inherit}.mv{max-width:2880px}.mw{padding-bottom:48.611111111111114%}.mx{margin-top:10px}.my{text-align:center}.ng{max-width:1400px}.nh{padding-bottom:52.857142857142854%}.ni{max-width:1280px}.nj{will-change:opacity}.nk{width:188px}.nl{left:50%}.nm{transform:translateX(406px)}.nn{top:calc(65px + 54px + 14px)}.nq{will-change:opacity, transform}.nr{transform:translateY(159px)}.nt{width:131px}.nu{padding-bottom:28px}.nv{border-bottom:1px solid rgba(230, 230, 230, 1)}.nw{padding-bottom:5px}.nx{padding-top:2px}.ny{padding-top:14px}.nz{padding-top:28px}.oa{margin-bottom:19px}.ob{margin-left:-3px}.oh{outline:0}.oi{border:0}.oj{user-select:none}.ok> svg{pointer-events:none}.om{-webkit-user-select:none}.ow button{text-align:left}.ox{opacity:1}.oy{padding-right:4px}.ph{margin-top:40px}.pi{border-top:3px solid rgba(102, 138, 170, 1)}.pj{padding:32px 32px 26px 32px}.pk{margin-top:8px}.pl{margin-bottom:25px}.pm{background-color:rgba(250, 250, 250, 1)}.po{padding-bottom:0px}.pp{padding-top:4px}.pq{font-size:13px}.pr{padding-top:8px}.qc{margin:10px 20px 10px 0}.qe{padding:7px 20px 9px}.qf{margin:10px 0 10px 0}.qg{max-width:380px}.qh{padding-bottom:25px}.qi{margin-top:25px}.qj{max-width:155px}.qn{top:1px}.qv{margin-left:-1px}.re{padding-bottom:40px}.rf{list-style-type:none}.rg{margin-bottom:8px}.rh{line-height:22px}.ri{border-radius:3px}.rj{padding:5px 10px}.rk{padding-bottom:4px}.rl{padding-top:32px}.rw{text-overflow:ellipsis}.rx{display:-webkit-box}.ry{-webkit-line-clamp:1}.rz{-webkit-box-orient:vertical}.sb{padding-top:5px}.sc{padding-right:168px}.sd{padding-top:25px}.sj{max-width:100%}.sk{margin-bottom:96px}.sl{padding:32px 0}.sm{background-color:rgba(0, 0, 0, 0.9)}.sq:disabled{color:rgba(255, 255, 255, 0.7)}.sr:disabled{fill:rgba(255, 255, 255, 0.7)}.ss{height:22px}.st{width:200px}.sv{color:rgba(255, 255, 255, 0.98)}.sz{color:rgba(255, 255, 255, 0.7)}.tc{margin-right:16px}.bm:hover{cursor:pointer}.bn:hover{color:rgba(251, 255, 255, 1)}.bo:hover{fill:rgba(251, 255, 255, 1)}.dj:hover{color:rgba(242, 248, 253, 1)}.dk:hover{fill:rgba(242, 248, 253, 1)}.ej:hover{background:rgba(90, 118, 144, 1)}.ek:hover{border-color:rgba(90, 118, 144, 1)}.ev:hover{color:rgba(25, 25, 25, 1)}.ew:hover{fill:rgba(25, 25, 25, 1)}.fv:hover{color:rgba(90, 118, 144, 1)}.fw:hover{fill:rgba(90, 118, 144, 1)}.jf:hover{fill:rgba(8, 8, 8, 1)}.oo:hover{fill:rgba(117, 117, 117, 1)}.so:hover{color:rgba(255, 255, 255, 0.99)}.sp:hover{fill:rgba(255, 255, 255, 0.99)}.sw:hover{text-decoration:underline}.jg:focus{fill:rgba(8, 8, 8, 1)}.md:focus{transform:scale(1.01)}.on:focus{fill:rgba(117, 117, 117, 1)}.ol:active{border-style:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.as{margin:0 64px}.hl{font-size:46px}.hm{margin-top:0.6em}.hn{line-height:56px}.ho{letter-spacing:-0.011em}.ie{font-size:22px}.if{margin-top:0.92em}.ig{line-height:28px}.ja{margin-left:30px}.ju{font-size:21px}.jv{line-height:32px}.jw{letter-spacing:-0.003em}.ke{margin-top:2em}.kj{margin-top:56px}.le{margin-top:1.72em}.lf{letter-spacing:0}.ll{margin-top:0.86em}.nf{margin-top:1.91em}.og{margin-right:5px}.ov{margin-top:5px}.pg{padding-left:6px}.qa{font-size:16px}.qb{line-height:24px}.qp{display:inline-block}.qu{width:8px}.rc{padding-left:7px}.rd{top:3px}.ru{font-size:20px}.rv{max-height:24px}.si{margin:0}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.iz{margin-left:30px}.lv{float:none}.lw{margin-left:0}.lx{margin-right:0}.ly{width:100%}.mz{margin-left:auto}.na{text-align:center}.of{margin-right:5px}.ou{margin-top:5px}.pf{padding-left:6px}.qo{display:inline-block}.qt{width:8px}.ra{padding-left:7px}.rb{top:3px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.iy{margin-left:30px}.oe{margin-right:5px}.ot{margin-top:5px}.pd{padding-left:6px}.pe{top:3px}.qm{display:inline-block}.qs{width:8px}.qz{padding-left:3px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.u{margin-bottom:20px}.af{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ag{min-height:230px}.ak{display:block}.bu{min-height:98px}.bv{display:flex}.bw{align-items:flex-start}.bx{flex-direction:column}.by{justify-content:flex-end}.cd{margin-bottom:28px}.ce{margin-top:0px}.ch{margin-top:28px}.dq{margin:0}.fh{border-top:1px solid rgba(230, 230, 230, 1)}.fi{border-bottom:1px solid rgba(230, 230, 230, 1)}.fr{align-items:center}.fs{flex:1 0 auto}.ij{margin-top:32px}.ik{flex-direction:column-reverse}.iw{margin-bottom:30px}.ix{margin-left:0px}.od{margin-left:8px}.or{margin-top:2px}.os{margin-right:8px}.pb{padding-left:6px}.pc{top:3px}.pn{padding:24px 24px 28px 24px}.ql{display:inline-block}.qr{width:8px}.qw{margin-left:-4px}.qy{padding-left:3px}.sn{padding:32px 0}.su{width:140px}.sx{margin-bottom:16px}.sy{margin-top:30px}.ta{width:100%}.tb{flex-direction:row}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ao{margin:0 24px}.gv{font-size:32px}.gw{margin-top:0.64em}.gx{line-height:40px}.gy{letter-spacing:-0.016em}.hs{font-size:18px}.ht{margin-top:0.79em}.hu{line-height:24px}.ii{margin-top:32px}.iu{margin-bottom:30px}.iv{margin-left:0px}.jk{line-height:28px}.jl{letter-spacing:-0.003em}.ka{margin-top:1.56em}.kf{margin-top:40px}.ku{font-size:20px}.kv{margin-top:1.23em}.kw{letter-spacing:0}.lh{margin-top:0.67em}.nb{margin-top:1.41em}.oc{margin-left:8px}.op{margin-top:2px}.oq{margin-right:8px}.oz{padding-left:6px}.pa{top:3px}.ps{font-size:14px}.pt{line-height:20px}.qd{margin:10px 0 0 0}.qk{display:inline-block}.qq{width:8px}.qx{padding-left:3px}.rm{font-size:16px}.rn{max-height:20px}.se{margin:0}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ar{margin:0 64px}.hh{font-size:46px}.hi{margin-top:0.6em}.hj{line-height:56px}.hk{letter-spacing:-0.011em}.ib{font-size:22px}.ic{margin-top:0.92em}.id{line-height:28px}.jr{font-size:21px}.js{line-height:32px}.jt{letter-spacing:-0.003em}.kd{margin-top:2em}.ki{margin-top:56px}.lc{margin-top:1.72em}.ld{letter-spacing:0}.lk{margin-top:0.86em}.ne{margin-top:1.91em}.py{font-size:16px}.pz{line-height:24px}.rs{font-size:20px}.rt{max-height:24px}.sh{margin:0}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.aq{margin:0 48px}.hd{font-size:46px}.he{margin-top:0.6em}.hf{line-height:56px}.hg{letter-spacing:-0.011em}.hy{font-size:22px}.hz{margin-top:0.92em}.ia{line-height:28px}.jo{font-size:21px}.jp{line-height:32px}.jq{letter-spacing:-0.003em}.kc{margin-top:2em}.kh{margin-top:56px}.la{margin-top:1.72em}.lb{letter-spacing:0}.lj{margin-top:0.86em}.nd{margin-top:1.91em}.pw{font-size:16px}.px{line-height:24px}.rq{font-size:20px}.rr{max-height:24px}.sg{margin:0}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ap{margin:0 24px}.gz{font-size:32px}.ha{margin-top:0.64em}.hb{line-height:40px}.hc{letter-spacing:-0.016em}.hv{font-size:18px}.hw{margin-top:0.79em}.hx{line-height:24px}.jm{line-height:28px}.jn{letter-spacing:-0.003em}.kb{margin-top:1.56em}.kg{margin-top:40px}.kx{font-size:20px}.ky{margin-top:1.23em}.kz{letter-spacing:0}.li{margin-top:0.67em}.nc{margin-top:1.41em}.pu{font-size:14px}.pv{line-height:20px}.ro{font-size:16px}.rp{max-height:20px}.sf{margin:0}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="print">.jb{display:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.fp{animation:k2 .2s ease-in-out both}.ma{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.no{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1230px)">.np{display:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1198px)">.ns{display:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.sa{max-height:none}</style><style data-fela-type="RULE" type="text/css" media="all and (max-width: 1330px)"></style><link rel="icon" href="https://miro.medium.com/fit/c/128/128/1*ChFMdf--f5jbm-AYv6VdYA@2x.png" data-rh="true"><link rel="preload" href="https://miro.medium.com/max/1401/1*sfUruIusLq6tbpLx0sDYZQ.png" as="image" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*DsDDxjH-J4v_Q8tTM1BXtw.png"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062","dateCreated":"2020-08-26T13:40:27.741Z","datePublished":"2020-08-26T13:40:27.741Z","dateModified":"2020-08-26T14:18:26.659Z","headline":"Hands-on guide to Python Optimal Transport toolbox: Part 2","name":"Hands-on guide to Python Optimal Transport toolbox: Part 2","description":"As a follow-up of my previous introductory article on optimal transport and a first part of this guide provided by Aurelie Boisbunon here, I will present below how you can solve different tasks with…","identifier":"783029a1f062","keywords":["Lite:true","Tag:Machine Learning","Tag:Artificial Intelligence","Tag:Towards Data Science","Tag:Mathematics","Tag:Code","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC","LayerCake:3"],"author":{"@type":"Person","name":"Ievgen Redko","url":"https:\u002F\u002Fievred.medium.com"},"creator":["Ievgen Redko"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":165,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F165\u002F1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><div class="s"><div class="t s u"><div class="ac ae s af ag"><div class="n ah ai"><div class="aj ak"><div class="al s am an"><div class="n p"><div class="ao ap aq ar as at au v"><div class="av n o"><div class="n o aw ax"><div class="mp" id="li-ShowPostUnderCollection-navbar-open-in-app-button"><div class="ay aj ak"><span class="az b ba bb bc"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F783029a1f062&amp;~feature=LiOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----783029a1f062--------------------------------" class="bd be bf bg bh bi bj bk bl bm bn bo bp te tf" rel="noopener nofollow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----783029a1f062--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q be"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="n p"><div class="ao ap aq ar as at au v"><div class="bs n o aw bt bu bv bw bx by"><div class="v n bz bt"><div class="n v"><div class="ca cb v n o aw cc cd ce bv bw bx"><div class="cf cg s ch"><a aria-label="Publication Homepage" rel="noopener" href="https://towardsdatascience.com/?source=post_page-----783029a1f062--------------------------------"><div class="ci cj s"><img alt="Towards Data Science" class="" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_AGyTPCaRzVqL77kFwUwHKg.png" width="112" height="35"></div></a></div></div></div><div class="n o ck cl an g"><div class="cm cn co n o"><div class="cp cq"><div class="n" aria-hidden="false" aria-describedby="publicationMenu" aria-labelledby="publicationMenu"><button aria-controls="publicationMenu" aria-expanded="false" aria-label="Publication Menu" class="cs ct bf bg bh bi bj bk bl cu bm"><div class="cv s"><svg class="cr bo" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></div></button></div></div><div class="cw cx s"><div class="cp cq"><div class="cy" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"><div class="n"><button class="cs di bf bg bh bi bj bk bl bm dj dk bp dl dm"><span class="cv s"><svg width="25" height="25" viewBox="0 0 25 25" class="cr"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></span></button><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-hidden="true" tabindex="-1" class="cz cu da db bb dc dd bd de am df dg dh" placeholder="Search" value=""></div></div></div></div></div><a href="https://medium.com/?source=post_page-----783029a1f062--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q dn"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><div class="s ak"><div class="n p"><div class="ao ap aq ar as at au v"><div class="w x y z ab"><div class="do dp n o"><div class="s dq"><span class="az b db dr ds dt du dv dw dx dy dz ea"><div class="n o"><div class="eb s"><div class="ec ed s"><div class="cy" aria-hidden="false" aria-describedby="collectionFollowPopover" aria-labelledby="collectionFollowPopover"><button class="az b ba bb ee ef eg eh ei ej ek bm el em en eo ep eq er es cy et" aria-controls="collectionFollowPopover" aria-expanded="false"><div class="n aw">Follow</div></button></div></div></div><div class="cm eu ah"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/followers?source=post_page-----783029a1f062--------------------------------">583K Followers</a></div><div class="ez s g">·</div><div class="ez s g"><nav class="n o"><span class="fa n ah"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/tagged/editors-pick?source=post_page-----783029a1f062--------------------------------">Editors' Picks</a></span><span class="fa n ah"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/tagged/tds-features?source=post_page-----783029a1f062--------------------------------">Features</a></span><span class="fa n ah"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/tagged/deep-dives?source=post_page-----783029a1f062--------------------------------">Deep Dives</a></span><span class="fa n ah"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/how-to-get-the-most-out-of-towards-data-science-3bf37f75a345?source=post_page-----783029a1f062--------------------------------">Grow</a></span><span class="fa n ah"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/questions-96667b06af5?source=post_page-----783029a1f062--------------------------------">Contribute</a></span></nav></div><div class="ez n ah g"><a class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener" href="https://towardsdatascience.com/about?source=post_page-----783029a1f062--------------------------------">About</a></div></div></span></div><div class="aj fb fc ak"><button class="n o p fd fe df ff" aria-label="Expand navbar"><svg width="14" height="14" class="fg"><path d="M0 .5h14M0 7h14M0 13.5h14"></path></svg></button></div></div></div></div></div></div></div><div class="fh fi fj al c fk dc fl fm fn mp an fp"><div class="n p"><div class="ao ap aq ar as at au v"><div class="fq v aj fn an bv fr"><div class="aj bv fr fs"><div class="mp" id="li-ShowPostUnderCollection-navbar-open-in-app-button"><div class="ay aj ak"><span class="az b ba bb ea"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F783029a1f062&amp;~feature=LiOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----783029a1f062--------------------------------" class="ft fu bf bg bh bi bj bk bl bm fv fw bp te tf" rel="noopener nofollow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----783029a1f062--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="s jb"><div class="th ti v mf fl tj tk ff dc gl tl" aria-hidden="true" role="presentation"></div><div class="tm fl tn to tp th mf es tq tr ts ox tt tu tv ta tw tx ty tz fo" aria-hidden="true"><div class="uc ud n o aw bt"><div class="n aw"><h2 class="az kt ue dr gs hq">Responses</h2></div><div class="n aw"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="8" aria-labelledby="8"><a href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=responses-----783029a1f062--------------------------------" class="io ew" target="_blank" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.99 5.04c.26-.21.64-.22.91-.01.97.72 1.77 1.21 2.6 1.54.83.32 1.72.48 2.89.5.41.01.74.35.74.76-.02 3.62-.43 6.26-1.45 8.21-1.03 1.98-2.66 3.21-4.97 4.08a.75.75 0 0 1-.53 0c-2.25-.87-3.86-2.1-4.9-4.07-1.02-1.95-1.46-4.59-1.48-8.22 0-.41.33-.75.75-.76 1.19-.02 2.1-.18 2.92-.5.82-.32 1.6-.81 2.52-1.53zm.46.9c-.9.69-1.71 1.21-2.62 1.56a8.9 8.9 0 0 1-3.02.57c.03 3.45.46 5.82 1.36 7.51.88 1.69 2.25 2.77 4.28 3.57 2.1-.8 3.47-1.89 4.34-3.57.89-1.7 1.3-4.07 1.34-7.51a8.8 8.8 0 0 1-3-.57 11.8 11.8 0 0 1-2.68-1.56zm0 9.15a2.67 2.67 0 1 0 0-5.34 2.67 2.67 0 0 0 0 5.34zm0 1a3.67 3.67 0 1 0 0-7.34 3.67 3.67 0 0 0 0 7.34zm-1.82-3.77l.53-.53.91.92 1.63-1.63.52.53-2.15 2.15-1.44-1.44z"></path></svg></a></div></div><div class="s am uf"><div class="s am fn fm"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" data-testid="close-button" aria-label="close"><svg width="25" height="25" viewBox="0 0 25 25" class="ct"><path d="M18.13 6.11l-5.61 5.61-5.6-5.61-.81.8 5.61 5.61-5.61 5.61.8.8 5.61-5.6 5.61 5.6.8-.8-5.6-5.6 5.6-5.62"></path></svg></button></div></div></div></div><div><div class="az b ba bb hq"><div class="dr"><div class="vr uv vs s"><div class="to vg ge n ah vh vi vj"><div class="n o bt am vk vl dc vm vn"><div class="n o"><div class="am uy cn"><div class="vt n aw o p fb vu vv vw nl vx gl"><svg width="39" height="39" viewBox="0 0 39 39"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 1C11.83 1 5.17 5.75 1.9 12.71L1 12.3C4.4 5.02 11.4 0 19.5 0S34.6 5.02 38 12.29l-.9.42C33.82 5.75 27.16 1 19.5 1zM1.9 26.29C5.18 33.25 11.84 38 19.5 38c7.67 0 14.33-4.75 17.6-11.71l.9.42C34.6 33.98 27.6 39 19.5 39S4.4 33.98 1 26.71l.9-.42z"></path></svg></div><img alt="Pb Fsu" class="s il cn uy" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/0_NpC-xma00ujUDrfW.jpg" width="32" height="32"></div><div class="ez n bz ah p"><p class="az b ba bb hq">Pb Fsu</p></div></div></div><div class="n ah"><div class="vo vp"><div class="vy s"><div data-gramm="false" role="textbox" data-slate-editor="true" data-slate-node="value" contenteditable="true" style="outline: none; white-space: pre-wrap; overflow-wrap: break-word;"><div data-slate-node="element"><p><span data-slate-node="text"><span data-slate-leaf="true"><span contenteditable="false" style="pointer-events: none; display: inline-block; width: 0px; max-width: 100%; white-space: nowrap; opacity: 0.333; user-select: none; font-style: normal; font-weight: normal; text-decoration: none;">What are your thoughts?</span><span data-slate-zero-width="n" data-slate-length="0">﻿<br></span></span></span></p></div></div></div></div><div class="bt n vk vq dc vm"><label class="n o"><div class="jd wo wp n wq am"><input class="vz wa wb fb dc wc wd we wf wg wh wi" type="checkbox"><span class="o gc wj eq er wk es ee ff n eg wl p wm wn"><svg width="11" height="11" viewBox="0 0 11 11" class="eg"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></span></div><p class="az b pq bb ea">Also publish to my profile</p></label><button class="az b ba bb ee wr eg ws wt wu wv bm el em ww wx ep eq er es cy et" disabled="">Respond</button></div></div></div></div></div></div></div><div class="ua my n ah p o mq ub"><p class="az b db dr ea">There are currently no responses for this story.</p><p class="az b db dr ea">Be the first to respond.</p></div></div></div><article class="meteredContent"><section class="fx fy fz ga v gb es s"><div></div></section><span class="s"></span><div><div class="fb fk ug gj gk gl"></div><section class="gm gn go dx gp"><div class="n p"><div class="ao ap aq ar as gq au v"><div class=""><h1 id="f183" class="gr gs gt az gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq">Hands-on guide to Python Optimal Transport toolbox: Part 2</h1></div><div class=""><h2 id="d571" class="hr gs gt az b hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ea">Color transfer, Image editing and Automatic translation</h2><div class="cf"><div class="n bt ii ij ik"><div class="o n"><div><a href="https://ievred.medium.com/?source=post_page-----783029a1f062--------------------------------" rel="noopener"><img alt="Ievgen Redko" class="s il im in" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/2_iQGwTuIBuEBKk-UjC9IZSQ.jpeg" width="28" height="28"></a></div><div class="ez v n cc"><div class="n"><div style="flex:1"><span class="az b ba bb hq"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><a href="https://ievred.medium.com/?source=post_page-----783029a1f062--------------------------------" class="" rel="noopener"><p class="az b ba bb ft">Ievgen Redko</p></a></div></div></span></div></div><span class="az b ba bb ea"><a class="" rel="noopener" href="https://towardsdatascience.com/hands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062?source=post_page-----783029a1f062--------------------------------"><p class="az b ba bb ea"><span class="ir"></span>Aug 26, 2020<span class="is">·</span>8 min read<svg class="io ip iq" width="15" height="15" viewBox="0 0 15 15"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></p></a></span></div></div><div class="n it iu iv iw ix iy iz ja jb"><div class="n o"><div class="jc s"><div class="cy" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div></div><div class="jd s"><div><div class="io"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="s ax"><div class="cy" aria-hidden="false" aria-describedby="creatorActionOverflowMenu" aria-labelledby="creatorActionOverflowMenu"><div class="cy" aria-hidden="false" aria-describedby="removeFromPublicationPopover" aria-labelledby="removeFromPublicationPopover"><div class="je s ck"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-controls="creatorActionOverflowMenu" aria-expanded="false" aria-label="More options"><svg class="r jf jg" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div><p id="7b08" class="jh ji gt jj b hs jk jl hv jm jn jo jp jq jr js jt ju jv jw jx jy gm hq" data-selectable-paragraph="">As a follow-up of my <a class="cs jz" rel="noopener" href="https://towardsdatascience.com/optimal-transport-a-hidden-gem-that-empowers-todays-machine-learning-2609bbf67e59">previous introductory article on optimal transport</a> and a first part of this guide provided by <a href="https://medium.com/@aboisbunon?source=post_page-----922a2e82e621----------------------" class="cs jz" rel="noopener">Aurelie Boisbunon</a> <a href="https://medium.com/@aboisbunon/hands-on-guide-to-python-optimal-transport-toolbox-part-1-922a2e82e621" class="cs jz" rel="noopener">here</a>, I will present below how you can solve different tasks with Optimal Transport (OT) in practice using the <a href="https://pythonot.github.io/" class="cs jz" rel="noopener nofollow">Python Optimal Transport (POT)</a> toolbox.</p><p id="9987" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">To start with, let us install POT using pip from the terminal by simply running</p><pre class="kf kg kh ki kj kk kl km"><span id="4087" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">pip3 install ot</span></pre><p id="63cd" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">And voilà! If everything went well, you now have POT installed and ready to use on your computer. Let me now explain how you can reproduce the results from my previous article.</p><h2 id="a68a" class="kn ko gt az kt ku kv hu kw kx ky hx kz hy la ia lb ib lc id ld ie le ig lf lg hq" data-selectable-paragraph="">Color transfer</h2><p id="b715" class="jh ji gt jj b hs lh jk jl hv li jm jn jo lj jp jq jr lk js jt ju ll jv jw jy gm hq" data-selectable-paragraph="">In this<span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"><span id="rmm"> </span></span></span></span></span>application our goal is to transfer the color style of one image onto another image in the smoothest way possible. To do this, we will follow <a href="https://pythonot.github.io/auto_examples/domain-adaptation/plot_otda_color_images.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-color-images-py" class="cs jz" rel="noopener nofollow">the example</a> from the official webpage of the POT library and start by defining several supplementary functions needed when working with images:</p><pre class="kf kg kh ki kj kk kl km"><span id="c76b" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">import numpy as np<br>import matplotlib.pylab as pl<br>import ot<br><br><br><a href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" class="cs jz" rel="noopener nofollow">r</a> = <a href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" class="cs jz" rel="noopener nofollow">np.random.RandomState</a>(42)<br><br><br>def im2mat(img):<br>    """Converts an image to a matrix (one pixel per line)"""<br>    return img.reshape((img.shape[0] * img.shape[1], img.shape[2]))<br><br><br>def mat2im(X, shape):<br>    """Converts a matrix back to an image"""<br>    return X.reshape(shape)</span></pre><p id="8be0" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">So, first three lines here are just imports for numpy, matplotlib.pylab and ot packages. Then, we have two functions that allow us to convert an image represented by a 3d matrix (some people call them tensors) where the first dimension is the height of the image, the second one is its width, while the third is given by RGB coordinates of the pixels. Let’s now load some images to see what it means.</p><pre class="kf kg kh ki kj kk kl km"><span id="e4da" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph=""><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" class="cs jz" rel="noopener nofollow">I1</a> = pl.imread('../../data/ocean_day.jpg').astype(<a href="https://docs.python.org/3/library/functions.html#float" class="cs jz" rel="noopener nofollow">np.float64</a>)/256<br><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" class="cs jz" rel="noopener nofollow">I2</a> = pl.imread('../../data/ocean_sunset.jpg').astype(<a href="https://docs.python.org/3/library/functions.html#float" class="cs jz" rel="noopener nofollow">np.float64</a>)/256</span></pre><figure class="kf kg kh ki kj ln gc lo er lp lq lr ls lt bk lu lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga lm"><div class="mj s am mk"><div class="ml mm s"><div class="dc me fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo fo wz" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_F243JPx9kylZnAWCEWRmIw.png" width="1079" height="363" role="presentation"></div><img alt="" class="ox uh fb fn fk mf v c" width="1079" height="363" role="presentation" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_F243JPx9kylZnAWCEWRmIw(1).png" srcset="https://miro.medium.com/max/276/1*F243JPx9kylZnAWCEWRmIw.png 276w, https://miro.medium.com/max/500/1*F243JPx9kylZnAWCEWRmIw.png 500w" sizes="500px"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/2158/1*F243JPx9kylZnAWCEWRmIw.png" width="1079" height="363" srcSet="https://miro.medium.com/max/552/1*F243JPx9kylZnAWCEWRmIw.png 276w, https://miro.medium.com/max/1000/1*F243JPx9kylZnAWCEWRmIw.png 500w" sizes="500px" role="presentation"/></noscript></div></div></div></div></figure><p id="f6e9" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Here they are, the daytime ocean image and the sunset one provided directly in the POT toolbox. Note that originally all the pixel RGB coordinates are integers so that astype(<a href="https://docs.python.org/3/library/functions.html#float" class="cs jz" rel="noopener nofollow">np.float64</a>) converts them to floats. Then, each value is divided by 256 (the maximum value of each pixel’s coordinate) to normalize the data to lie in [0,1] interval. If we check their dimensions, we get the following</p><pre class="kf kg kh ki kj kk kl km"><span id="fc5e" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">print(I1[0,0,:])<br>[0.0234375 0.2421875 0.53125]</span></pre><p id="652d" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">This means that the first pixel in the bottom left corner has RGB coordinates given by the vector [R = 0.0234375, G= 0.2421875, B = 0.53125] (blue color dominates as expected for the daytime image). We now convert our tensors to a 2d matrix where each line is a pixel described by its RGB coordinates as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="dffc" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">day = im2mat(I1)<br>sunset = im2mat(I2)</span></pre><p id="2ca8" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Note that these matrices are rather large as can be seen by running the following code:</p><pre class="kf kg kh ki kj kk kl km"><span id="8fa1" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">print(day.shape)<br>(669000, 3)</span></pre><p id="43ac" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Let’s sample 1000 pixels randomly from each image to reduce the size of the matrices that we will apply OT to. We can do it as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="0721" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">nb = 1000<br>idx1 = r.randint(day.shape[0], size=(nb,)) <br>idx2 = r.randint(sunset.shape[0], size=(nb,))<br><br>Xs = day[idx1, :]<br>Xt = sunset[idx2, :]</span></pre><p id="7a1c" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">We now have two matrices with only 1000 rows and 3 columns in each of them. Let’s plot them in the RB (red-blue) plane to see the pixels of what color we actually sampled:</p><pre class="kf kg kh ki kj kk kl km"><span id="693f" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">plt.subplot(1, 2, 1)<br>plt.scatter(Xs[:, 0], Xs[:, 2], c=Xs)<br><em class="mq">#plt.axis([0, 1, 0, 1])<br></em>plt.xlabel(<strong class="kp gu">'Red'</strong>)<br>plt.ylabel(<strong class="kp gu">'Blue'</strong>)<br>plt.xticks([])<br>plt.yticks([])<br>plt.title(<strong class="kp gu">'Day'</strong>)<br><br>plt.subplot(1, 2, 2)<br><br>plt.scatter(Xt[:, 0], Xt[:, 2], c=Xt)<br><em class="mq">#plt.axis([0, 1, 0, 1])<br></em>plt.xlabel(<strong class="kp gu">'Red'</strong>)<br>plt.ylabel(<strong class="kp gu">'Blue'</strong>)<br>plt.title(<strong class="kp gu">'Sunset'</strong>)<br>plt.xticks([])<br>plt.yticks([])<br>plt.tight_layout()<em class="mq"><br></em>plt.show()</span></pre><p id="d9b0" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">The result will look like this:</p><figure class="kf kg kh ki kj ln fz ga paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga mr"><div class="mj s am mk"><div class="ms mm s"><div class="ox uh fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo mp" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_mG3Y3rEKoyn-wMUiRy8kyA.png" width="3840" height="1800" role="presentation"></div><img alt="" class="dc me fb fn fk mf v c" width="3840" height="1800" role="presentation"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/7680/1*mG3Y3rEKoyn-wMUiRy8kyA.png" width="3840" height="1800" srcSet="https://miro.medium.com/max/552/1*mG3Y3rEKoyn-wMUiRy8kyA.png 276w, https://miro.medium.com/max/1104/1*mG3Y3rEKoyn-wMUiRy8kyA.png 552w, https://miro.medium.com/max/1280/1*mG3Y3rEKoyn-wMUiRy8kyA.png 640w, https://miro.medium.com/max/1400/1*mG3Y3rEKoyn-wMUiRy8kyA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="141b" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Everything seems to be set up to finally run our OT algorithm on them. To this end, we create an instance of the Monge-Kantorovich problem class and fit it on our images:</p><pre class="kf kg kh ki kj kk kl km"><span id="b625" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">ot_emd = ot.da.EMDTransport()<br>ot_emd.fit(Xs=Xs, Xt=Xt)</span></pre><p id="e67a" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Note that we create an instance of <em class="mq">ot.da.EMDTransport()</em> class that provides features for doing domain adaptation with OT and defines automatically the uniform empirical distributions (each pixel is a point having a probability 1/1000) and the cost matrix (squared Euclidean distance between vectors of pixel coordinates) when we call its <em class="mq">fit() </em>method. We can now “transport” one image onto another one using the coupling matrix as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="a046" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">transp_Xt_emd = ot_emd.inverse_transform(Xt=sunset)</span></pre><p id="64fb" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">The function <em class="mq">inverse_transform()</em> we’ve just called transports the sunset image to the daytime one using a barycentric mapping: each transported pixel in the final result is an average of pixels from the sunset image weighted by the corresponding values of the coupling matrix. You can do the same thing the other way around by calling <em class="mq">transform(Xs=day) </em>too. We now plot the final result as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="426c" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">I2t = mat2im(transp_Xt_emd, I2.shape)<br><br>plt.figure()<br>plt.imshow(I2t)<br>plt.axis(<strong class="kp gu">'off'</strong>)<br>plt.title(<strong class="kp gu">'Color transfer'</strong>)<br>plt.tight_layout()<br>plt.show()</span></pre><p id="2764" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">And it gives the desired result:</p><figure class="kf kg kh ki kj ln fz ga paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga mr"><div class="mj s am mk"><div class="mt mm s"><div class="ox uh fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo mp" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_tlw_W6z3rVuz2CDVceGfKA.png" width="3840" height="2880" role="presentation"></div><img alt="" class="dc me fb fn fk mf v c" width="3840" height="2880" role="presentation"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/7680/1*tlw_W6z3rVuz2CDVceGfKA.png" width="3840" height="2880" srcSet="https://miro.medium.com/max/552/1*tlw_W6z3rVuz2CDVceGfKA.png 276w, https://miro.medium.com/max/1104/1*tlw_W6z3rVuz2CDVceGfKA.png 552w, https://miro.medium.com/max/1280/1*tlw_W6z3rVuz2CDVceGfKA.png 640w, https://miro.medium.com/max/1400/1*tlw_W6z3rVuz2CDVceGfKA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h2 id="5063" class="kn ko gt az kt ku kv hu kw kx ky hx kz hy la ia lb ib lc id ld ie le ig lf lg hq" data-selectable-paragraph=""><strong class="bj"><em class="mu">Image editing</em></strong></h2><p id="ddca" class="jh ji gt jj b hs lh jk jl hv li jm jn jo lj jp jq jr lk js jt ju ll jv jw jy gm hq" data-selectable-paragraph="">We now want to do a seamless copy that consists in editing an image by replacing a part of it using a patch of another image. For instance, this can be you face transported onto the fact of the Mona Lisa painting. To proceed, we will first need to download the <em class="mq">poissonblending.py</em> file from <a href="https://github.com/ncourty/PoissonGradient" class="cs jz" rel="noopener nofollow">this github repository</a>. Then, we will load three images from the data folder (you need to put them there beforehand) as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="671e" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph=""><strong class="kp gu">import </strong>matplotlib.pyplot <strong class="kp gu">as </strong>plt<br><strong class="kp gu">from </strong>poissonblending <strong class="kp gu">import </strong>blend<br><br><br>img_mask = plt.imread(<strong class="kp gu">'./data/me_mask_copy.png'</strong>)<br>img_mask = img_mask[:,:,:3] <em class="mq"># remove alpha<br><br></em>img_source = plt.imread(<strong class="kp gu">'./data/me_blend_copy.jpg'</strong>)<br>img_source = img_source[:,:,:3] <em class="mq"># remove alpha<br><br></em>img_target = plt.imread(<strong class="kp gu">'./data/target.png'</strong>)<br>img_target = img_target[:,:,:3] <em class="mq"># remove alpha</em></span></pre><p id="1da8" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">First image is my portrait, second image provides the area of my portrait that will be copied into the Mona Lisa’s face. The pre-processing also removes the transparency and keeps only RGB values for each pixel. Overall, they will look as follows:</p><figure class="kf kg kh ki kj ln fz ga paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga mv"><div class="mj s am mk"><div class="mw mm s"><div class="ox uh fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo mp" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_ANU13t3bvXHD8n0EevNqqQ.png" width="2880" height="1400" role="presentation"></div><img alt="" class="dc me fb fn fk mf v c" width="2880" height="1400" role="presentation"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/5760/1*ANU13t3bvXHD8n0EevNqqQ.png" width="2880" height="1400" srcSet="https://miro.medium.com/max/552/1*ANU13t3bvXHD8n0EevNqqQ.png 276w, https://miro.medium.com/max/1104/1*ANU13t3bvXHD8n0EevNqqQ.png 552w, https://miro.medium.com/max/1280/1*ANU13t3bvXHD8n0EevNqqQ.png 640w, https://miro.medium.com/max/1400/1*ANU13t3bvXHD8n0EevNqqQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="mx my gb fz ga mz na az b ba bb ea" data-selectable-paragraph="">You can adjust the mask using any image editor with simple geometrical objects.</figcaption></figure><p id="cb7d" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">The final result can then be obtained using the <em class="mq">blend()</em> function called as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="ea22" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">nbsample = 500<br>off = (35,-15)</span><span id="1168" class="hq kn ko gt kp b db nb nc nd ne nf kr s ks" data-selectable-paragraph="">seamless_copy = blend(img_target, img_source, img_mask, reg=5, eta=1, nbsubsample=nbsample, offset=off, adapt=<strong class="kp gu">'kernel'</strong>)</span></pre><p id="91d0" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Once again, we apply OT only to a subset of 500 pixels as doing it for the whole image will take some time. The code behind this function involves many image pre-processing routines but what is of a special interest for us is the OT part. This is represented by the <em class="mq">adapt_Gradients_kernel() from</em> <em class="mq">poissonblending.py </em>that contains the following code:</p><pre class="kf kg kh ki kj kk kl km"><span id="56cd" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">Xs, Xt = subsample(G_src,G_tgt,nb)<br><br>ot_mapping=ot.da.MappingTransport(mu=mu,eta=eta,bias=bias, max_inner_iter = 10,verbose=<strong class="kp gu">True</strong>, inner_tol=1e-06)<br>ot_mapping.fit(Xs=Xs,Xt=Xt)</span><span id="5503" class="hq kn ko gt kp b db nb nc nd ne nf kr s ks" data-selectable-paragraph=""><strong class="kp gu">return </strong>ot_mapping.transform(Xs=G_src)</span></pre><p id="a15c" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">The first line here extracts two samples of 500 pixels from the gradients G_src,G_tgt. Then, <em class="mq">ot.da.MappingTransport() </em>function learns a non-linear (kernelized) transformation that approximates the barycentric mapping that we have used in the previous example. You may wonder why is that needed? Well, the barycentric mapping relies on the coupling matrix that aligns only the samples it was fitted on (it’s shape is number of samples from the first distribution * number of samples from the second one) and thus it cannot be used to out-of-sample points. Finally, the return uses this approximation just as before to transport the gradient of my face onto the gradient of the Mona Lisa’s portrait. The final result is then given by:</p><figure class="kf kg kh ki kj ln fz ga paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga mv"><div class="mj s am mk"><div class="mw mm s"><div class="ox uh fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo mp" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_DsDDxjH-J4v_Q8tTM1BXtw.png" width="2880" height="1400" role="presentation"></div><img alt="" class="dc me fb fn fk mf v c" width="2880" height="1400" role="presentation"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/5760/1*DsDDxjH-J4v_Q8tTM1BXtw.png" width="2880" height="1400" srcSet="https://miro.medium.com/max/552/1*DsDDxjH-J4v_Q8tTM1BXtw.png 276w, https://miro.medium.com/max/1104/1*DsDDxjH-J4v_Q8tTM1BXtw.png 552w, https://miro.medium.com/max/1280/1*DsDDxjH-J4v_Q8tTM1BXtw.png 640w, https://miro.medium.com/max/1400/1*DsDDxjH-J4v_Q8tTM1BXtw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="mx my gb fz ga mz na az b ba bb ea" data-selectable-paragraph="">Rightmost image by Author.</figcaption></figure><h2 id="f2f9" class="kn ko gt az kt ku kv hu kw kx ky hx kz hy la ia lb ib lc id ld ie le ig lf lg hq" data-selectable-paragraph="">Automatic translation</h2><figure class="kf kg kh ki kj ln gc lo er lp lq lr ls lt bk lu lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga ng"><div class="mj s am mk"><div class="nh mm s"><div class="ox uh fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo mp" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_FkzlFyi6qEVEUSeRXs5cIw.png" width="1400" height="740" role="presentation"></div><img alt="" class="dc me fb fn fk mf v c" width="1400" height="740" role="presentation"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/2800/1*FkzlFyi6qEVEUSeRXs5cIw.png" width="1400" height="740" srcSet="https://miro.medium.com/max/552/1*FkzlFyi6qEVEUSeRXs5cIw.png 276w, https://miro.medium.com/max/1000/1*FkzlFyi6qEVEUSeRXs5cIw.png 500w" sizes="500px" role="presentation"/></noscript></div></div></div></div></figure><p id="1061" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">For this last application, our goal is to take find an optimal alignment between the words in two sentences given in the different languages. As an example, we will work with the English proposition “<em class="mq">the cat sits on the mat</em>’’ and its French translation “<em class="mq">le chat est assis sur le tapis</em>’’ with the goal of recovering a matching that provides the correspondences “<em class="mq">cat</em>”- “<em class="mq">chat</em>”, “<em class="mq">sits</em>”- “<em class="mq">assis</em>” and “<em class="mq">mat</em>”- “<em class="mq">tapis</em>”. For this, we will need the nltk library that can be installed via pip as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="5eef" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">pip3 install nltk</span></pre><p id="8add" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">We will also need to clone <a href="https://github.com/balikasg/WassersteinRetrieval" class="cs jz" rel="noopener nofollow">the following github repository</a> and to follow its readme in order to download the embeddings that will be used to describe our propositions (I also provide a shortcut to this here where you can find directly the embeddings for the considered pair).</p><p id="acb6" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Let us now do some usual imports and add two functions that will be used afterwards.</p><pre class="kf kg kh ki kj kk kl km"><span id="5eca" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph=""><strong class="kp gu">import </strong>numpy <strong class="kp gu">as </strong>np, sys, codecs<br><strong class="kp gu">import </strong>ot<br><strong class="kp gu">import </strong>nltk<br>nltk.download(<strong class="kp gu">'stopwords'</strong>) # download stopwords<br>nltk.download(<strong class="kp gu">'punkt'</strong>) # download punctuation <br><br><strong class="kp gu">from </strong>nltk <strong class="kp gu">import </strong>word_tokenize<br><strong class="kp gu">import </strong>matplotlib.pyplot <strong class="kp gu">as </strong>plt<br><br><strong class="kp gu">def </strong>load_embeddings(path, dimension):<br>    <em class="mq">"""<br>    Loads the embeddings from a file with word2vec format.<br>    The word2vec format is one line per words and its associated embedding.<br>    """<br>    </em>f = codecs.open(path, encoding=<strong class="kp gu">"utf8"</strong>).read().splitlines()<br>    vectors = {}<br>    <strong class="kp gu">for </strong>i <strong class="kp gu">in </strong>f:<br>        elems = i.split()<br>        vectors[<strong class="kp gu">" "</strong>.join(elems[:-dimension])] =  <strong class="kp gu">" "</strong>.join(elems[-dimension:])<br>    <strong class="kp gu">return </strong>vectors<br><br><strong class="kp gu">def </strong>clean(embeddings_dico, corpus, vectors, language, stops, instances = 10000):<br>    <em class="mq"><br>    </em>clean_corpus, clean_vectors, keys = [], {}, []<br>    words_we_want = set(embeddings_dico).difference(stops)<br>    <strong class="kp gu">for </strong>key, doc <strong class="kp gu">in </strong>enumerate(corpus):<br>        clean_doc = []<br>        words = word_tokenize(doc<em class="mq">)<br>        </em><strong class="kp gu">for </strong>word <strong class="kp gu">in </strong>words:<br>            word = word.lower()<br>            <strong class="kp gu">if </strong>word <strong class="kp gu">in </strong>words_we_want:<br>                clean_doc.append(word+<strong class="kp gu">"__%s"</strong>%language)<br>                clean_vectors[word+<strong class="kp gu">"__%s"</strong>%language] = np.array(vectors[word].split()).astype(np.float)<br>        <strong class="kp gu"><br>        if </strong>len(clean_doc) &gt; 5 :<br>            keys.append(key)<br>        clean_corpus.append(<strong class="kp gu">" "</strong>.join(clean_doc))<br>    <strong class="kp gu">return </strong>clean_vectors</span></pre><p id="9fd5" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">First function is used to load the embeddings, while the second pre-process the text to remove all the stopwords and punctuation.</p><p id="05df" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">To proceed, we now load the embeddings for English and French languages as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="e42a" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">vectors_en = load_embeddings(<strong class="kp gu">"concept_net_1706.300.en"</strong>, 300) <em class="mq"><br></em>vectors_fr = load_embeddings(<strong class="kp gu">"concept_net_1706.300.fr"</strong>, 300) </span></pre><p id="6dab" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">And define the two propositions to be translated:</p><pre class="kf kg kh ki kj kk kl km"><span id="3a21" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">en = [<strong class="kp gu">"the cat sits on the mat"</strong>]<br>fr = [<strong class="kp gu">"le chat est assis sur le tapis"</strong>]</span></pre><p id="f643" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Let us now clean our sentences as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="7dc8" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">clean_en = clean(set(vectors_en.keys()), en, vectors_en, <strong class="kp gu">"en"</strong>, set(nltk.corpus.stopwords.words(<strong class="kp gu">"english"</strong>)))</span><span id="e9f1" class="hq kn ko gt kp b db nb nc nd ne nf kr s ks" data-selectable-paragraph="">clean_fr = clean(set(vectors_fr.keys()), fr, vectors_fr, <strong class="kp gu">"fr"</strong>, set(nltk.corpus.stopwords.words(<strong class="kp gu">"french"</strong>)))</span></pre><p id="f491" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">This returns only the embeddings of meaningful words “<em class="mq">cat</em>”, “<em class="mq">sits</em>”, “<em class="mq">mat</em>” and “<em class="mq">chat</em>”, “<em class="mq">assis</em>” and “<em class="mq">tapis</em>”. Everything is now set for optimal transport to be used. As shown in the image above, we define two empirical uniform distributions over the terms and run OT between them with a cost matrix given by pairwise square Euclidean distances.</p><pre class="kf kg kh ki kj kk kl km"><span id="8dfc" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">emp_en = np.ones((len(en_emd),))/len(en_emd)<br>emp_fr =  np.ones((len(fr_emd),))/len(fr_emd)<br>M = ot.dist(en_emd,fr_emd)<br><br>coupling = ot.emd(emp_en, emp_fr, M)</span></pre><p id="2d9a" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Once the coupling is obtained, we can now find a projection of our embeddings to 2d space with t-SNE and then plot the corresponding words and their matched pairs as follows:</p><pre class="kf kg kh ki kj kk kl km"><span id="667d" class="hq kn ko gt kp b db kq kr s ks" data-selectable-paragraph="">np.random.seed(2) # fix the seed for visualization purpose<br><br>en_embedded = TSNE(n_components=3).fit_transform(en_emd)<br>fr_embedded = TSNE(n_components=3).fit_transform(fr_emd)<br><br>f, ax = plt.subplots()<br>plt.tick_params(top=<strong class="kp gu">False</strong>, bottom=<strong class="kp gu">False</strong>, left=<strong class="kp gu">False</strong>, right=<strong class="kp gu">False</strong>, labelleft=<strong class="kp gu">False</strong>, labelbottom=<strong class="kp gu">False</strong>)<br>plt.axis(<strong class="kp gu">'off'</strong>)<br>ax.scatter(en_embedded[:,0], en_embedded[:,1], c = <strong class="kp gu">'blue'</strong>, s = 50, marker = <strong class="kp gu">'s'</strong>)<br><br><strong class="kp gu">for </strong>i <strong class="kp gu">in </strong>range(len(en)):<br>    ax.annotate(en[i], (en_embedded[i,0], en_embedded[i,1]), ha = <strong class="kp gu">'right'</strong>, va = <strong class="kp gu">'bottom'</strong>, fontsize = 30)<br><br>ax.scatter(fr_embedded[:,0], fr_embedded[:,1], c = <strong class="kp gu">'red'</strong>, s = 50, marker = <strong class="kp gu">'s'</strong>)<br><br><strong class="kp gu">for </strong>i <strong class="kp gu">in </strong>range(len(fr)):<br>    ax.annotate(fr[i], (fr_embedded[i,0], fr_embedded[i,1]), va = <strong class="kp gu">'top'</strong>, fontsize = 30)<br><br>coupling /= np.max(coupling)<br><br><strong class="kp gu">for </strong>i, j <strong class="kp gu">in </strong>enumerate(np.array(np.argmax(coupling, axis= 1)).flatten()):<br>    ax.plot([en_embedded[i, 0], fr_embedded[j, 0]], [en_embedded[i, 1], fr_embedded[j, 1]], c=<strong class="kp gu">'k'</strong>)<br><br>plt.show()</span></pre><p id="e013" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">This gives the final result:</p><figure class="kf kg kh ki kj ln gc lo er lp lq lr ls lt bk lu lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ma mb am mc v md"><div class="fz ga ni"><div class="mj s am mk"><div class="mt mm s"><div class="ox uh fb fn fk mf v mg mh mi"><img alt="" class="fb fn fk mf v mn mo mp" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_-Ih9cJ-zWRaB9QWvtNo2-Q.png" width="1280" height="960" role="presentation"></div><img alt="" class="dc me fb fn fk mf v c" width="1280" height="960" role="presentation"><noscript><img alt="" class="fb fn fk mf v" src="https://miro.medium.com/max/2560/1*-Ih9cJ-zWRaB9QWvtNo2-Q.png" width="1280" height="960" srcSet="https://miro.medium.com/max/552/1*-Ih9cJ-zWRaB9QWvtNo2-Q.png 276w, https://miro.medium.com/max/1000/1*-Ih9cJ-zWRaB9QWvtNo2-Q.png 500w" sizes="500px" role="presentation"/></noscript></div></div></div></div><figcaption class="mx my gb fz ga mz na az b ba bb ea" data-selectable-paragraph="">Image by Author.</figcaption></figure><p id="e503" class="jh ji gt jj b hs ka jk jl hv kb jm jn jo kc jp jq jr kd js jt ju ke jv jw jy gm hq" data-selectable-paragraph="">Note that the latter examples can be extended to do automatic translation based on the wikipidea data available on the github repository from which we took the initial code. For more details, you can also check the corresponding paper and the results therein to further boost the performance.</p></div></div></section></div></article><div class="dc gl fl nq v uu fn no uj" data-test-id="post-sidebar"><div class="n p"><div class="ao ap aq ar as at au v"><div class="uk n ah"><div class="gl"><div><div class="ul s"><div class="nw s"><a href="https://ievred.medium.com/?source=post_sidebar--------------------------post_sidebar-----------" class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener"><h2 class="az kt db bb gs hq gm">Ievgen Redko</h2></a></div><div class="nx s"><p class="az b ba bb ea">Associate professor in CS/ML, <a href="http://ievred.github.io/" class="cs di bf bg bh bi bj bk bl bm bp ex ey jz gn" rel="noopener nofollow">ievred.github.io/</a>, <a href="http://twitter.com/IevgenRedko" class="cs di bf bg bh bi bj bk bl bm bp ex ey jz gn" rel="noopener nofollow">twitter.com/IevgenRedko</a></p></div><div class="ny s"><button class="az b ba bb ee ef eg eh ei ej ek bm el em en eo ep eq er es cy et">Follow</button></div></div><div class="rl uo n aw up"><div class="oa ob uq ur n"><div class="n o"><div class="s am oc od oe of og"><div class=""><button class="bk oh oi oj ff ok ol tg r on oo"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="s op oq or os ot ou ov"><div class="ow"><p class="az b ba bb ea"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey">56 </button></p></div></div></div></div><div class="oa tc s"><button class="ff oi bk"><div class="oy n o aw"><svg width="25" height="25" class="r ox ff oo" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s am oz pa pb pc pd pe pf pg"></div></div></button></div><div><div class="io"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></div><div class="dc gl nj fl nk nl nm nn no np"></div><div><div class="ph ln n ah p"><div class="n p"><div class="ao ap aq ar as gq au v"><div class="n cc"></div><div class="n o cc"></div><div class="pi pj pk pl pm pn"><div class="po s"><h2 class="az kt ku hu kw kx hx kz hy ia lb ib id ld ie ig lf hq">Sign up for The Variable</h2></div><div class="pp s"><h3 class="az b pq bb hq">By Towards Data Science</h3></div><div class="lu pr s"><p class="az b ps pt pu pv pw px py pz qa qb hq">Every Thursday, the Variable delivers the very best of Towards Data Science: from hands-on tutorials and cutting-edge research to original features you don't want to miss.&nbsp;<a href="https://medium.com/towards-data-science/newsletters/the-variable?source=newsletter_v3_promo--------------------------newsletter_v3_promo-----------" class="cs di bf bg bh bi bj bk bl bm bp ex ey jz" rel="noopener">Take a look.</a></p></div><div class="n cc"><div class="qc s qd"><button class="az b db dr ee qe eg eh ei ej ek bm el em en eo ep eq er es cy et"><span class="jd" aria-hidden="true"><svg width="20" height="16" viewBox="0 0 20 16"><path d="M0 .35v15.3h20V.35H0zm6.95 9.38l3.05 2.5 3.05-2.5 4.88 4.73H2.07l4.88-4.73zM1.2 13.64V5.02l4.82 3.94-4.82 4.68zm12.78-4.68l4.82-3.94v8.62l-4.82-4.68zm4.82-7.42v1.94l-8.8 7.2-8.8-7.2V1.54h17.6z"></path></svg></span>Get this newsletter</button></div><div class="qf qg s"><p class="az b pq bb hq">Emails will be sent to pb.fsu10@gmail.com.<div class="s"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fhands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062&amp;source=newsletter_v3_promo--------------------------newsletter_v3_promo-----------" class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener"><button class="cs di bf bg bh bi bj bk bl bm bp ex ey jz" target="_blank">Not you?</button></a></span></div></p></div></div></div><div class="qh ph s"><div class="qi n bt jb"><div class="n o aw"><div class="qj s"><span class="s qk ql qm e d"><div class="n o"><div class="s am oc od oe of og"><div class=""><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><button class="bk oh oi oj ff ok ol om r on oo"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div></div></div><div class="s op oq or os ot ou ov"><div class="am qn ow"><p class="az b ba bb hq"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey">56<span class="s h g f qo qp">&nbsp;</span></button><span class="s h g f qo qp"></span></p></div></div></div></span><span class="s h g f qo qp"><div class="n o"><div class="s am oc od oe of og"><div class=""><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><button class="bk oh oi oj ff ok ol om r on oo"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div></div></div><div class="s op oq or os ot ou ov"><div class="ow"><p class="az b ba bb hq"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey">56 </button></p></div></div></div></span></div><div class="s qq qr qs qt qu"></div><button class="ff oi bk"><div class="oy n o aw"><span class="qv s qw"><svg width="25" height="25" class="r ox ff oo" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s am qx pa qy pc qz pe ra rb rc rd"></div></div></button></div><div class="n o"><div class="jc s"><div class="cy" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="6" aria-labelledby="6"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div></div><div class="jc s ck"><div><div class="io"><div><div class="cy" role="tooltip" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="cy" aria-hidden="false" aria-describedby="creatorActionOverflowMenu" aria-labelledby="creatorActionOverflowMenu"><div class="cy" aria-hidden="false" aria-describedby="removeFromPublicationPopover" aria-labelledby="removeFromPublicationPopover"><div class="je s ck"><button class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" aria-controls="creatorActionOverflowMenu" aria-expanded="false" aria-label="More options"><svg class="r jf jg" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div><div class="re qi s"><ul class="bk bl"><li class="cy rf jd rg"><a href="https://towardsdatascience.com/tagged/machine-learning" class="az b pq rh ea ri rj et s kl">Machine Learning</a></li><li class="cy rf jd rg"><a href="https://towardsdatascience.com/tagged/artificial-intelligence" class="az b pq rh ea ri rj et s kl">Artificial Intelligence</a></li><li class="cy rf jd rg"><a href="https://towardsdatascience.com/tagged/towards-data-science" class="az b pq rh ea ri rj et s kl">Towards Data Science</a></li><li class="cy rf jd rg"><a href="https://towardsdatascience.com/tagged/mathematics" class="az b pq rh ea ri rj et s kl">Mathematics</a></li><li class="cy rf jd rg"><a href="https://towardsdatascience.com/tagged/code" class="az b pq rh ea ri rj et s kl">Code</a></li></ul></div></div></div><div><div class="n p"><div class="ao ap aq ar as gq au v"></div></div><div class="s jb"><div class="rk rl s pm"><div class="n p"><div class="ao ap aq ar as gq au v"><div class="n o bt"><h2 class="az kt rm pt rn kw ro pv rp kz rq px rr lb rs pz rt ld ru qb rv lf mg rw rx ry rz sa hq"><a href="https://towardsdatascience.com/?source=follow_footer-------------------------------------" class="cs di bf bg bh bi bj bk bl bm ev ew bp ex ey" rel="noopener">More from Towards Data Science</a></h2><div class="cy" aria-hidden="false" aria-describedby="collectionFollowPopover" aria-labelledby="collectionFollowPopover"><button class="az b ba bb ee ef eg eh ei ej ek bm el em en eo ep eq er es cy et" aria-controls="collectionFollowPopover" aria-expanded="false"><div class="n aw">Follow</div></button></div></div><div class="sb sc s"><p class="az b ba bb ea">Your home for data science. A Medium publication sharing concepts, ideas and codes.</p></div></div></div></div></div><div class="sd s pm jb"><div class="n p"><div class="se sf sg sh si sj au v"><div class="sk ph s"><div class="sj s my"><a href="https://towardsdatascience.com/?source=follow_footer-------------------------------------" class="az b ba bb ee ef eg eh ei ej ek bm el em en eo ep eq er es cy et" rel="noopener">Read more from <!-- -->Towards Data Science</a></div></div></div></div></div><div class="s gc jb"><div class="n p"><div class="ao ap aq ar as at au v"></div></div></div></div></div></div><div class="sl s sm sn"><div class="n p"><div class="ao ap aq ar as at au v"><div class="n ah"><div class="n o bt"><a href="https://medium.com/?source=post_page-----783029a1f062--------------------------------" class="cs di bf bg bh bi bj bk bl bm so sp bp sq sr" rel="noopener"><svg viewBox="0 0 3940 610" class="eg ss"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="pr st n bt su bv"><p class="az b db dr sv"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----783029a1f062--------------------------------" class="cs di bf bg bh bi bj bk bl bm sw bp sq sr" rel="noopener">About</a></p><p class="az b db dr sv"><a href="https://help.medium.com/hc/en-us?source=post_page-----783029a1f062--------------------------------" class="cs di bf bg bh bi bj bk bl bm sw bp sq sr" rel="noopener">Help</a></p><p class="az b db dr sv"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----783029a1f062--------------------------------" class="cs di bf bg bh bi bj bk bl bm sw bp sq sr" rel="noopener">Legal</a></p></div></div><div class="aj sx sy bv"><p class="az b db dr sz">Get the Medium app</p></div><div class="aj sx ta bv tb"><div class="tc s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----783029a1f062--------------------------------" class="cs di bf bg bh bi bj bk bl bm so sp bp sq sr" rel="noopener nofollow"><img alt="A button that says &#39;Download on the App Store&#39;, and if clicked it will lead you to the iOS App store" class="" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----783029a1f062--------------------------------" class="cs di bf bg bh bi bj bk bl bm so sp bp sq sr" rel="noopener nofollow"><img alt="A button that says &#39;Get it on, Google Play&#39;, and if clicked it will lead you to the Google Play store" class="" src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1_W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210420-225321-8f0662176b"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":true},"bookReader":{"assets":{},"reader":{"currentAsset":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":false,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":[],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"COLLECTION","id":"7f60cf5620c9","explicit":true}},"debug":{"requestId":"3b05fefa-0ff2-4f80-85fd-0cac3357d786","branchDeployConfig":null,"hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"46ee120b1bb62eb6","ot-tracer-traceid":"49af5918c3015d0f","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062","host":"towardsdatascience.com","hostname":"towardsdatascience.com","referrer":"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-1-922a2e82e621","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210420-225321-8f0662176b","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210420-225321-8f0662176b"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210420-225321-8f0662176b","commit":"8f0662176b8fb712ebca4debb5ab3c07a6aeed6c"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e","9dc80918cc93","8a9336e5bb4","cef6983b292","54c98c43354d","193b68bd4fba","b7e45b22fec3","55760f21cdc5"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":"70f3e9695270"}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"deindex_from_external_search_threshold","valueType":{"__typename":"VariantFlagString","value":"1293868800000"}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_blogrolls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_custom_domain_v2_settings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_dedicated_series_tab_api_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_generation_pipeline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_from_creators_you_are_enjoying_above_based_on_your_readings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_cancelled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_expired","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hightower_user_minimum_guarantee","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_who_to_follow_module","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_write_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hot_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kiln_for_digest_followed_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_gift_checkout","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pay_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_member_only_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_welcome_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_checkout_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_login_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_user_onboarding_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_nsfw_filtering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_tax_status_clarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publish_to_email_for_publication_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_receipt_notes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_removal_of_digest_follow_promo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_follow_feed_cache","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_s3_sites","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_stripegate","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_twitter_auth_suggestions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"entity_driven_subscription_milestone_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"filter_last_seen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"posts_under_quota_fair_distribution","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_evergreen_section","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_low_quality_content_from_tags","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_low_quality_posts_from_internal_search","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"postResult({\"id\":\"783029a1f062\"})":{"__ref":"Post:783029a1f062"},"meterPost({\"postId\":\"783029a1f062\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-1-922a2e82e621\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"viewer":{"__ref":"User:c6c44791e380"}},"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png":{"id":"1*ChFMdf--f5jbm-AYv6VdYA@2x.png","__typename":"ImageMetadata"},"CustomStyleSheet:63d23b36fcaa":{"id":"63d23b36fcaa","__typename":"CustomStyleSheet","global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_2"}}},"header":{"__typename":"HeaderStyles","backgroundColor":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"rgb":"355876","alpha":"99"},"postBackgroundColor":null,"backgroundImage":{"__ref":"ImageMetadata:1*sfUruIusLq6tbpLx0sDYZQ.png"},"headerScale":"HEADER_SCALE_MEDIUM","horizontalAlignment":"CENTER","backgroundImageDisplayMode":"IMAGE_DISPLAY_MODE_FILL","backgroundImageVerticalAlignment":"END","backgroundColorDisplayMode":"COLOR_DISPLAY_MODE_SOLID","secondaryBackgroundColor":null,"nameColor":null,"nameTreatment":"NAME_TREATMENT_LOGO","postNameTreatment":"NAME_TREATMENT_LOGO","logoImage":{"__ref":"ImageMetadata:1*AGyTPCaRzVqL77kFwUwHKg.png"},"logoScale":"HEADER_SCALE_LARGE","taglineColor":{"__typename":"ColorValue","rgb":"ffffff","alpha":"ff"},"taglineTreatment":"TAGLINE_TREATMENT_HEADER"},"navigation":{"__typename":"HeaderNavigation","navItems":[{"__typename":"HeaderNavigationItem","name":"Editors' Picks","href":null,"type":"NAV_TYPE_TAG","tags":[{"__ref":"Tag:editors-pick"}],"tagSlugs":["editors-pick"]},{"__typename":"HeaderNavigationItem","name":"Features","href":null,"type":"NAV_TYPE_TAG","tags":[{"__ref":"Tag:tds-features"}],"tagSlugs":["tds-features"]},{"__typename":"HeaderNavigationItem","name":"Deep Dives","href":null,"type":"NAV_TYPE_TAG","tags":[{"__ref":"Tag:deep-dives"}],"tagSlugs":["deep-dives"]},{"__typename":"HeaderNavigationItem","name":"Grow","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fhow-to-get-the-most-out-of-towards-data-science-3bf37f75a345","type":"NAV_TYPE_LINK","tags":[],"tagSlugs":[]},{"__typename":"HeaderNavigationItem","name":"Contribute","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fquestions-96667b06af5","type":"NAV_TYPE_LINK","tags":[],"tagSlugs":[]}]},"postBody":null,"blogroll":null},"ImageMetadata:1*sfUruIusLq6tbpLx0sDYZQ.png":{"id":"1*sfUruIusLq6tbpLx0sDYZQ.png","__typename":"ImageMetadata","originalWidth":1401},"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png":{"id":"1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","__typename":"ImageMetadata","originalWidth":337,"originalHeight":122},"User:7e12c71dfa81":{"id":"7e12c71dfa81","__typename":"User","atsQualifiedAt":1612205680542},"ImageMetadata:1*eLxNtw6hQ4-3HrHda5BCCw.png":{"id":"1*eLxNtw6hQ4-3HrHda5BCCw.png","__typename":"ImageMetadata"},"NewsletterV3:d6fe9076899":{"id":"d6fe9076899","__typename":"NewsletterV3","slug":"the-variable","isSubscribed":false,"showPromo":true,"name":"The Variable","description":"Every Thursday, the Variable delivers the very best of Towards Data Science: from hands-on tutorials and cutting-edge research to original features you don't want to miss.","collection":{"__ref":"Collection:7f60cf5620c9"},"type":"NEWSLETTER_TYPE_COLLECTION","user":{"__ref":"User:895063a310f4"}},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","__typename":"Collection","domain":"towardsdatascience.com","googleAnalyticsId":null,"slug":"towards-data-science","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":true,"favicon":{"__ref":"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png"},"name":"Towards Data Science","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"customStyleSheet":{"__ref":"CustomStyleSheet:63d23b36fcaa"},"tagline":"A Medium publication sharing concepts, ideas and codes.","isAuroraEligible":true,"viewerIsEditor":false,"logo":{"__ref":"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"},"navItems":[{"__typename":"NavItem","title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Video","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fvideo\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"★","url":"https:\u002F\u002Ftowardsdatascience.com\u002Feditors-picks\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"About","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fabout-us\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Contribute","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:7e12c71dfa81"},"subscriberCount":583358,"avatar":{"__ref":"ImageMetadata:1*eLxNtw6hQ4-3HrHda5BCCw.png"},"newsletterV3":{"__ref":"NewsletterV3:d6fe9076899"},"viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"canToggleEmail":true,"isUserSubscribedToCollectionEmails":false,"viewerIsMuting":false,"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"description":"Your home for data science. A Medium publication sharing concepts, ideas and codes.","ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","status":"ACTIVE","isSubdomain":false}},"ptsQualifiedAt":1616092952992},"User:fde5e3dd8903":{"id":"fde5e3dd8903","__typename":"User","isFollowing":false,"viewerIsUser":false,"customStyleSheet":null,"isSuspended":false,"name":"Ievgen Redko","hasCompletedProfile":false,"bio":"Associate professor in CS\u002FML, ievred.github.io\u002F, twitter.com\u002FIevgenRedko","imageId":"2*iQGwTuIBuEBKk-UjC9IZSQ.jpeg","username":"ievred","customDomainState":{"__typename":"CustomDomainState","pending":null,"live":{"__typename":"CustomDomain","status":"ACTIVE","domain":"ievred.medium.com","isSubdomain":true}},"isAuroraVisible":true,"createdAt":0,"mediumMemberAt":0,"lastPostCreatedAt":0,"socialStats":{"__typename":"SocialStats","followerCount":46,"followingCount":15},"hasSubdomain":true,"isAllowEdsEnabled":false,"isBlocking":false,"isMuting":false,"allowNotes":true,"newsletterV3":{"__ref":"NewsletterV3:98cb622434ea"},"twitterScreenName":"","followedCollections":1,"atsQualifiedAt":1612205275598},"ImageMetadata:1*AGyTPCaRzVqL77kFwUwHKg.png":{"id":"1*AGyTPCaRzVqL77kFwUwHKg.png","__typename":"ImageMetadata","originalWidth":1376,"originalHeight":429},"Tag:editors-pick":{"id":"editors-pick","__typename":"Tag","normalizedTagSlug":""},"Tag:tds-features":{"id":"tds-features","__typename":"Tag","normalizedTagSlug":""},"Tag:deep-dives":{"id":"deep-dives","__typename":"Tag","normalizedTagSlug":""},"Topic:ae5d4995e225":{"id":"ae5d4995e225","__typename":"Topic","name":"Data Science","slug":"data-science","isFollowing":null},"Paragraph:efb9f427cb40_0":{"id":"efb9f427cb40_0","__typename":"Paragraph","name":"f183","text":"Hands-on guide to Python Optimal Transport toolbox: Part 2","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_1":{"id":"efb9f427cb40_1","__typename":"Paragraph","name":"d571","text":"Color transfer, Image editing and Automatic translation","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_2":{"id":"efb9f427cb40_2","__typename":"Paragraph","name":"7b08","text":"As a follow-up of my previous introductory article on optimal transport and a first part of this guide provided by Aurelie Boisbunon here, I will present below how you can solve different tasks with Optimal Transport (OT) in practice using the Python Optimal Transport (POT) toolbox.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":21,"end":71,"type":"A","href":"https:\u002F\u002Ftowardsdatascience.com\u002Foptimal-transport-a-hidden-gem-that-empowers-todays-machine-learning-2609bbf67e59","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":115,"end":132,"type":"A","href":"https:\u002F\u002Fmedium.com\u002F@aboisbunon?source=post_page-----922a2e82e621----------------------","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":133,"end":137,"type":"A","href":"https:\u002F\u002Fmedium.com\u002F@aboisbunon\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-1-922a2e82e621","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":244,"end":274,"type":"A","href":"https:\u002F\u002Fpythonot.github.io\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_3":{"id":"efb9f427cb40_3","__typename":"Paragraph","name":"9987","text":"To start with, let us install POT using pip from the terminal by simply running","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_4":{"id":"efb9f427cb40_4","__typename":"Paragraph","name":"4087","text":"pip3 install ot","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_5":{"id":"efb9f427cb40_5","__typename":"Paragraph","name":"63cd","text":"And voilà! If everything went well, you now have POT installed and ready to use on your computer. Let me now explain how you can reproduce the results from my previous article.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_6":{"id":"efb9f427cb40_6","__typename":"Paragraph","name":"a68a","text":"Color transfer","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_7":{"id":"efb9f427cb40_7","__typename":"Paragraph","name":"b715","text":"In this application our goal is to transfer the color style of one image onto another image in the smoothest way possible. To do this, we will follow the example from the official webpage of the POT library and start by defining several supplementary functions needed when working with images:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":150,"end":161,"type":"A","href":"https:\u002F\u002Fpythonot.github.io\u002Fauto_examples\u002Fdomain-adaptation\u002Fplot_otda_color_images.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-color-images-py","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_8":{"id":"efb9f427cb40_8","__typename":"Paragraph","name":"c76b","text":"import numpy as np\nimport matplotlib.pylab as pl\nimport ot\n\n\nr = np.random.RandomState(42)\n\n\ndef im2mat(img):\n    \"\"\"Converts an image to a matrix (one pixel per line)\"\"\"\n    return img.reshape((img.shape[0] * img.shape[1], img.shape[2]))\n\n\ndef mat2im(X, shape):\n    \"\"\"Converts a matrix back to an image\"\"\"\n    return X.reshape(shape)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":61,"end":62,"type":"A","href":"https:\u002F\u002Fnumpy.org\u002Fdoc\u002Fstable\u002Freference\u002Frandom\u002Flegacy.html#numpy.random.RandomState","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":65,"end":86,"type":"A","href":"https:\u002F\u002Fnumpy.org\u002Fdoc\u002Fstable\u002Freference\u002Frandom\u002Flegacy.html#numpy.random.RandomState","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_9":{"id":"efb9f427cb40_9","__typename":"Paragraph","name":"8be0","text":"So, first three lines here are just imports for numpy, matplotlib.pylab and ot packages. Then, we have two functions that allow us to convert an image represented by a 3d matrix (some people call them tensors) where the first dimension is the height of the image, the second one is its width, while the third is given by RGB coordinates of the pixels. Let’s now load some images to see what it means.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_10":{"id":"efb9f427cb40_10","__typename":"Paragraph","name":"e4da","text":"I1 = pl.imread('..\u002F..\u002Fdata\u002Focean_day.jpg').astype(np.float64)\u002F256\nI2 = pl.imread('..\u002F..\u002Fdata\u002Focean_sunset.jpg').astype(np.float64)\u002F256","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":2,"type":"A","href":"https:\u002F\u002Fnumpy.org\u002Fdoc\u002Fstable\u002Freference\u002Fgenerated\u002Fnumpy.ndarray.html#numpy.ndarray","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":50,"end":60,"type":"A","href":"https:\u002F\u002Fdocs.python.org\u002F3\u002Flibrary\u002Ffunctions.html#float","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":66,"end":68,"type":"A","href":"https:\u002F\u002Fnumpy.org\u002Fdoc\u002Fstable\u002Freference\u002Fgenerated\u002Fnumpy.ndarray.html#numpy.ndarray","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":119,"end":129,"type":"A","href":"https:\u002F\u002Fdocs.python.org\u002F3\u002Flibrary\u002Ffunctions.html#float","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_11":{"id":"efb9f427cb40_11","__typename":"Paragraph","name":"fc03","text":"","type":"IMG","href":null,"layout":"OUTSET_LEFT","metadata":{"__ref":"ImageMetadata:1*F243JPx9kylZnAWCEWRmIw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_12":{"id":"efb9f427cb40_12","__typename":"Paragraph","name":"f6e9","text":"Here they are, the daytime ocean image and the sunset one provided directly in the POT toolbox. Note that originally all the pixel RGB coordinates are integers so that astype(np.float64) converts them to floats. Then, each value is divided by 256 (the maximum value of each pixel’s coordinate) to normalize the data to lie in [0,1] interval. If we check their dimensions, we get the following","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":175,"end":185,"type":"A","href":"https:\u002F\u002Fdocs.python.org\u002F3\u002Flibrary\u002Ffunctions.html#float","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_13":{"id":"efb9f427cb40_13","__typename":"Paragraph","name":"fc5e","text":"print(I1[0,0,:])\n[0.0234375 0.2421875 0.53125]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_14":{"id":"efb9f427cb40_14","__typename":"Paragraph","name":"652d","text":"This means that the first pixel in the bottom left corner has RGB coordinates given by the vector [R = 0.0234375, G= 0.2421875, B = 0.53125] (blue color dominates as expected for the daytime image). We now convert our tensors to a 2d matrix where each line is a pixel described by its RGB coordinates as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_15":{"id":"efb9f427cb40_15","__typename":"Paragraph","name":"dffc","text":"day = im2mat(I1)\nsunset = im2mat(I2)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_16":{"id":"efb9f427cb40_16","__typename":"Paragraph","name":"2ca8","text":"Note that these matrices are rather large as can be seen by running the following code:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_17":{"id":"efb9f427cb40_17","__typename":"Paragraph","name":"8fa1","text":"print(day.shape)\n(669000, 3)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_18":{"id":"efb9f427cb40_18","__typename":"Paragraph","name":"43ac","text":"Let’s sample 1000 pixels randomly from each image to reduce the size of the matrices that we will apply OT to. We can do it as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_19":{"id":"efb9f427cb40_19","__typename":"Paragraph","name":"0721","text":"nb = 1000\nidx1 = r.randint(day.shape[0], size=(nb,)) \nidx2 = r.randint(sunset.shape[0], size=(nb,))\n\nXs = day[idx1, :]\nXt = sunset[idx2, :]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_20":{"id":"efb9f427cb40_20","__typename":"Paragraph","name":"7a1c","text":"We now have two matrices with only 1000 rows and 3 columns in each of them. Let’s plot them in the RB (red-blue) plane to see the pixels of what color we actually sampled:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_21":{"id":"efb9f427cb40_21","__typename":"Paragraph","name":"693f","text":"plt.subplot(1, 2, 1)\nplt.scatter(Xs[:, 0], Xs[:, 2], c=Xs)\n#plt.axis([0, 1, 0, 1])\nplt.xlabel('Red')\nplt.ylabel('Blue')\nplt.xticks([])\nplt.yticks([])\nplt.title('Day')\n\nplt.subplot(1, 2, 2)\n\nplt.scatter(Xt[:, 0], Xt[:, 2], c=Xt)\n#plt.axis([0, 1, 0, 1])\nplt.xlabel('Red')\nplt.ylabel('Blue')\nplt.title('Sunset')\nplt.xticks([])\nplt.yticks([])\nplt.tight_layout()\nplt.show()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":94,"end":99,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":112,"end":118,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":160,"end":165,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":263,"end":268,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":281,"end":287,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":299,"end":307,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":59,"end":83,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":228,"end":252,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":357,"end":358,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_22":{"id":"efb9f427cb40_22","__typename":"Paragraph","name":"d9b0","text":"The result will look like this:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_23":{"id":"efb9f427cb40_23","__typename":"Paragraph","name":"04a0","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mG3Y3rEKoyn-wMUiRy8kyA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_24":{"id":"efb9f427cb40_24","__typename":"Paragraph","name":"141b","text":"Everything seems to be set up to finally run our OT algorithm on them. To this end, we create an instance of the Monge-Kantorovich problem class and fit it on our images:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_25":{"id":"efb9f427cb40_25","__typename":"Paragraph","name":"b625","text":"ot_emd = ot.da.EMDTransport()\not_emd.fit(Xs=Xs, Xt=Xt)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_26":{"id":"efb9f427cb40_26","__typename":"Paragraph","name":"e67a","text":"Note that we create an instance of ot.da.EMDTransport() class that provides features for doing domain adaptation with OT and defines automatically the uniform empirical distributions (each pixel is a point having a probability 1\u002F1000) and the cost matrix (squared Euclidean distance between vectors of pixel coordinates) when we call its fit() method. We can now “transport” one image onto another one using the coupling matrix as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":35,"end":55,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":338,"end":344,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_27":{"id":"efb9f427cb40_27","__typename":"Paragraph","name":"a046","text":"transp_Xt_emd = ot_emd.inverse_transform(Xt=sunset)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_28":{"id":"efb9f427cb40_28","__typename":"Paragraph","name":"64fb","text":"The function inverse_transform() we’ve just called transports the sunset image to the daytime one using a barycentric mapping: each transported pixel in the final result is an average of pixels from the sunset image weighted by the corresponding values of the coupling matrix. You can do the same thing the other way around by calling transform(Xs=day) too. We now plot the final result as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":13,"end":32,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":335,"end":353,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_29":{"id":"efb9f427cb40_29","__typename":"Paragraph","name":"426c","text":"I2t = mat2im(transp_Xt_emd, I2.shape)\n\nplt.figure()\nplt.imshow(I2t)\nplt.axis('off')\nplt.title('Color transfer')\nplt.tight_layout()\nplt.show()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":77,"end":82,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":94,"end":110,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_30":{"id":"efb9f427cb40_30","__typename":"Paragraph","name":"2764","text":"And it gives the desired result:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_31":{"id":"efb9f427cb40_31","__typename":"Paragraph","name":"43aa","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tlw_W6z3rVuz2CDVceGfKA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_32":{"id":"efb9f427cb40_32","__typename":"Paragraph","name":"5063","text":"Image editing","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":13,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":13,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_33":{"id":"efb9f427cb40_33","__typename":"Paragraph","name":"ddca","text":"We now want to do a seamless copy that consists in editing an image by replacing a part of it using a patch of another image. For instance, this can be you face transported onto the fact of the Mona Lisa painting. To proceed, we will first need to download the poissonblending.py file from this github repository. Then, we will load three images from the data folder (you need to put them there beforehand) as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":290,"end":312,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fncourty\u002FPoissonGradient","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":261,"end":279,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_34":{"id":"efb9f427cb40_34","__typename":"Paragraph","name":"671e","text":"import matplotlib.pyplot as plt\nfrom poissonblending import blend\n\n\nimg_mask = plt.imread('.\u002Fdata\u002Fme_mask_copy.png')\nimg_mask = img_mask[:,:,:3] # remove alpha\n\nimg_source = plt.imread('.\u002Fdata\u002Fme_blend_copy.jpg')\nimg_source = img_source[:,:,:3] # remove alpha\n\nimg_target = plt.imread('.\u002Fdata\u002Ftarget.png')\nimg_target = img_target[:,:,:3] # remove alpha","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":7,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":25,"end":28,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":32,"end":37,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":53,"end":60,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":90,"end":115,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":185,"end":211,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":285,"end":304,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":145,"end":161,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":245,"end":261,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":338,"end":352,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_35":{"id":"efb9f427cb40_35","__typename":"Paragraph","name":"1da8","text":"First image is my portrait, second image provides the area of my portrait that will be copied into the Mona Lisa’s face. The pre-processing also removes the transparency and keeps only RGB values for each pixel. Overall, they will look as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_36":{"id":"efb9f427cb40_36","__typename":"Paragraph","name":"795d","text":"You can adjust the mask using any image editor with simple geometrical objects.","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ANU13t3bvXHD8n0EevNqqQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_37":{"id":"efb9f427cb40_37","__typename":"Paragraph","name":"cb7d","text":"The final result can then be obtained using the blend() function called as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":48,"end":55,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_38":{"id":"efb9f427cb40_38","__typename":"Paragraph","name":"ea22","text":"nbsample = 500\noff = (35,-15)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_39":{"id":"efb9f427cb40_39","__typename":"Paragraph","name":"1168","text":"seamless_copy = blend(img_target, img_source, img_mask, reg=5, eta=1, nbsubsample=nbsample, offset=off, adapt='kernel')","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":110,"end":118,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_40":{"id":"efb9f427cb40_40","__typename":"Paragraph","name":"91d0","text":"Once again, we apply OT only to a subset of 500 pixels as doing it for the whole image will take some time. The code behind this function involves many image pre-processing routines but what is of a special interest for us is the OT part. This is represented by the adapt_Gradients_kernel() from poissonblending.py that contains the following code:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":266,"end":295,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":296,"end":315,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_41":{"id":"efb9f427cb40_41","__typename":"Paragraph","name":"56cd","text":"Xs, Xt = subsample(G_src,G_tgt,nb)\n\not_mapping=ot.da.MappingTransport(mu=mu,eta=eta,bias=bias, max_inner_iter = 10,verbose=True, inner_tol=1e-06)\not_mapping.fit(Xs=Xs,Xt=Xt)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":123,"end":127,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_42":{"id":"efb9f427cb40_42","__typename":"Paragraph","name":"5503","text":"return ot_mapping.transform(Xs=G_src)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":7,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_43":{"id":"efb9f427cb40_43","__typename":"Paragraph","name":"a15c","text":"The first line here extracts two samples of 500 pixels from the gradients G_src,G_tgt. Then, ot.da.MappingTransport() function learns a non-linear (kernelized) transformation that approximates the barycentric mapping that we have used in the previous example. You may wonder why is that needed? Well, the barycentric mapping relies on the coupling matrix that aligns only the samples it was fitted on (it’s shape is number of samples from the first distribution * number of samples from the second one) and thus it cannot be used to out-of-sample points. Finally, the return uses this approximation just as before to transport the gradient of my face onto the gradient of the Mona Lisa’s portrait. The final result is then given by:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":93,"end":118,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_44":{"id":"efb9f427cb40_44","__typename":"Paragraph","name":"3da3","text":"Rightmost image by Author.","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*DsDDxjH-J4v_Q8tTM1BXtw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_45":{"id":"efb9f427cb40_45","__typename":"Paragraph","name":"f2f9","text":"Automatic translation","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_46":{"id":"efb9f427cb40_46","__typename":"Paragraph","name":"c2a7","text":"","type":"IMG","href":null,"layout":"OUTSET_LEFT","metadata":{"__ref":"ImageMetadata:1*FkzlFyi6qEVEUSeRXs5cIw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_47":{"id":"efb9f427cb40_47","__typename":"Paragraph","name":"1061","text":"For this last application, our goal is to take find an optimal alignment between the words in two sentences given in the different languages. As an example, we will work with the English proposition “the cat sits on the mat’’ and its French translation “le chat est assis sur le tapis’’ with the goal of recovering a matching that provides the correspondences “cat”- “chat”, “sits”- “assis” and “mat”- “tapis”. For this, we will need the nltk library that can be installed via pip as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":200,"end":223,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":254,"end":284,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":361,"end":364,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":368,"end":372,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":376,"end":380,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":384,"end":389,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":396,"end":399,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":403,"end":408,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_48":{"id":"efb9f427cb40_48","__typename":"Paragraph","name":"5eef","text":"pip3 install nltk","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_49":{"id":"efb9f427cb40_49","__typename":"Paragraph","name":"8add","text":"We will also need to clone the following github repository and to follow its readme in order to download the embeddings that will be used to describe our propositions (I also provide a shortcut to this here where you can find directly the embeddings for the considered pair).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":27,"end":58,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fbalikasg\u002FWassersteinRetrieval","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_50":{"id":"efb9f427cb40_50","__typename":"Paragraph","name":"acb6","text":"Let us now do some usual imports and add two functions that will be used afterwards.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_51":{"id":"efb9f427cb40_51","__typename":"Paragraph","name":"5eca","text":"import numpy as np, sys, codecs\nimport ot\nimport nltk\nnltk.download('stopwords') # download stopwords\nnltk.download('punkt') # download punctuation \n\nfrom nltk import word_tokenize\nimport matplotlib.pyplot as plt\n\ndef load_embeddings(path, dimension):\n    \"\"\"\n    Loads the embeddings from a file with word2vec format.\n    The word2vec format is one line per words and its associated embedding.\n    \"\"\"\n    f = codecs.open(path, encoding=\"utf8\").read().splitlines()\n    vectors = {}\n    for i in f:\n        elems = i.split()\n        vectors[\" \".join(elems[:-dimension])] =  \" \".join(elems[-dimension:])\n    return vectors\n\ndef clean(embeddings_dico, corpus, vectors, language, stops, instances = 10000):\n    \n    clean_corpus, clean_vectors, keys = [], {}, []\n    words_we_want = set(embeddings_dico).difference(stops)\n    for key, doc in enumerate(corpus):\n        clean_doc = []\n        words = word_tokenize(doc)\n        for word in words:\n            word = word.lower()\n            if word in words_we_want:\n                clean_doc.append(word+\"__%s\"%language)\n                clean_vectors[word+\"__%s\"%language] = np.array(vectors[word].split()).astype(np.float)\n        \n        if len(clean_doc) \u003E 5 :\n            keys.append(key)\n        clean_corpus.append(\" \".join(clean_doc))\n    return clean_vectors","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":7,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":13,"end":16,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":32,"end":39,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":42,"end":49,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":68,"end":79,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":116,"end":123,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":150,"end":155,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":160,"end":167,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":181,"end":188,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":206,"end":209,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":214,"end":218,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":438,"end":444,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":487,"end":491,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":493,"end":496,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":541,"end":544,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":574,"end":577,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":607,"end":614,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":623,"end":627,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":823,"end":827,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":836,"end":839,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":924,"end":928,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":933,"end":936,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":987,"end":990,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":995,"end":998,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":1051,"end":1057,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":1103,"end":1109,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":1179,"end":1191,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":1269,"end":1272,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":1294,"end":1301,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":256,"end":407,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":708,"end":713,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":914,"end":924,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_52":{"id":"efb9f427cb40_52","__typename":"Paragraph","name":"9fd5","text":"First function is used to load the embeddings, while the second pre-process the text to remove all the stopwords and punctuation.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_53":{"id":"efb9f427cb40_53","__typename":"Paragraph","name":"05df","text":"To proceed, we now load the embeddings for English and French languages as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_54":{"id":"efb9f427cb40_54","__typename":"Paragraph","name":"e42a","text":"vectors_en = load_embeddings(\"concept_net_1706.300.en\", 300) \nvectors_fr = load_embeddings(\"concept_net_1706.300.fr\", 300) ","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":29,"end":54,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":91,"end":116,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":61,"end":62,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_55":{"id":"efb9f427cb40_55","__typename":"Paragraph","name":"6dab","text":"And define the two propositions to be translated:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_56":{"id":"efb9f427cb40_56","__typename":"Paragraph","name":"3a21","text":"en = [\"the cat sits on the mat\"]\nfr = [\"le chat est assis sur le tapis\"]","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":6,"end":31,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":39,"end":71,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_57":{"id":"efb9f427cb40_57","__typename":"Paragraph","name":"f643","text":"Let us now clean our sentences as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_58":{"id":"efb9f427cb40_58","__typename":"Paragraph","name":"7dc8","text":"clean_en = clean(set(vectors_en.keys()), en, vectors_en, \"en\", set(nltk.corpus.stopwords.words(\"english\")))","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":57,"end":61,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":95,"end":104,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_59":{"id":"efb9f427cb40_59","__typename":"Paragraph","name":"e9f1","text":"clean_fr = clean(set(vectors_fr.keys()), fr, vectors_fr, \"fr\", set(nltk.corpus.stopwords.words(\"french\")))","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":57,"end":61,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":95,"end":103,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_60":{"id":"efb9f427cb40_60","__typename":"Paragraph","name":"f491","text":"This returns only the embeddings of meaningful words “cat”, “sits”, “mat” and “chat”, “assis” and “tapis”. Everything is now set for optimal transport to be used. As shown in the image above, we define two empirical uniform distributions over the terms and run OT between them with a cost matrix given by pairwise square Euclidean distances.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":54,"end":57,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":61,"end":65,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":69,"end":72,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":79,"end":83,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":87,"end":92,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":99,"end":104,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_61":{"id":"efb9f427cb40_61","__typename":"Paragraph","name":"8dfc","text":"emp_en = np.ones((len(en_emd),))\u002Flen(en_emd)\nemp_fr =  np.ones((len(fr_emd),))\u002Flen(fr_emd)\nM = ot.dist(en_emd,fr_emd)\n\ncoupling = ot.emd(emp_en, emp_fr, M)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_62":{"id":"efb9f427cb40_62","__typename":"Paragraph","name":"2d9a","text":"Once the coupling is obtained, we can now find a projection of our embeddings to 2d space with t-SNE and then plot the corresponding words and their matched pairs as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_63":{"id":"efb9f427cb40_63","__typename":"Paragraph","name":"667d","text":"np.random.seed(2) # fix the seed for visualization purpose\n\nen_embedded = TSNE(n_components=3).fit_transform(en_emd)\nfr_embedded = TSNE(n_components=3).fit_transform(fr_emd)\n\nf, ax = plt.subplots()\nplt.tick_params(top=False, bottom=False, left=False, right=False, labelleft=False, labelbottom=False)\nplt.axis('off')\nax.scatter(en_embedded[:,0], en_embedded[:,1], c = 'blue', s = 50, marker = 's')\n\nfor i in range(len(en)):\n    ax.annotate(en[i], (en_embedded[i,0], en_embedded[i,1]), ha = 'right', va = 'bottom', fontsize = 30)\n\nax.scatter(fr_embedded[:,0], fr_embedded[:,1], c = 'red', s = 50, marker = 's')\n\nfor i in range(len(fr)):\n    ax.annotate(fr[i], (fr_embedded[i,0], fr_embedded[i,1]), va = 'top', fontsize = 30)\n\ncoupling \u002F= np.max(coupling)\n\nfor i, j in enumerate(np.array(np.argmax(coupling, axis= 1)).flatten()):\n    ax.plot([en_embedded[i, 0], fr_embedded[j, 0]], [en_embedded[i, 1], fr_embedded[j, 1]], c='k')\n\nplt.show()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":218,"end":223,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":232,"end":237,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":244,"end":249,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":257,"end":262,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":274,"end":279,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":293,"end":298,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":309,"end":314,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":367,"end":373,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":392,"end":395,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":398,"end":402,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":404,"end":407,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":489,"end":496,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":503,"end":511,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":580,"end":585,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":604,"end":607,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":610,"end":614,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":616,"end":619,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":701,"end":706,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":754,"end":758,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":763,"end":766,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":921,"end":924,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:efb9f427cb40_64":{"id":"efb9f427cb40_64","__typename":"Paragraph","name":"e013","text":"This gives the final result:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_65":{"id":"efb9f427cb40_65","__typename":"Paragraph","name":"06e1","text":"Image by Author.","type":"IMG","href":null,"layout":"OUTSET_LEFT","metadata":{"__ref":"ImageMetadata:1*-Ih9cJ-zWRaB9QWvtNo2-Q.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:efb9f427cb40_66":{"id":"efb9f427cb40_66","__typename":"Paragraph","name":"e503","text":"Note that the latter examples can be extended to do automatic translation based on the wikipidea data available on the github repository from which we took the initial code. For more details, you can also check the corresponding paper and the results therein to further boost the performance.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"ImageMetadata:1*F243JPx9kylZnAWCEWRmIw.png":{"id":"1*F243JPx9kylZnAWCEWRmIw.png","__typename":"ImageMetadata","originalHeight":363,"originalWidth":1079,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*mG3Y3rEKoyn-wMUiRy8kyA.png":{"id":"1*mG3Y3rEKoyn-wMUiRy8kyA.png","__typename":"ImageMetadata","originalHeight":1800,"originalWidth":3840,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*tlw_W6z3rVuz2CDVceGfKA.png":{"id":"1*tlw_W6z3rVuz2CDVceGfKA.png","__typename":"ImageMetadata","originalHeight":2880,"originalWidth":3840,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*ANU13t3bvXHD8n0EevNqqQ.png":{"id":"1*ANU13t3bvXHD8n0EevNqqQ.png","__typename":"ImageMetadata","originalHeight":1400,"originalWidth":2880,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*DsDDxjH-J4v_Q8tTM1BXtw.png":{"id":"1*DsDDxjH-J4v_Q8tTM1BXtw.png","__typename":"ImageMetadata","originalHeight":1400,"originalWidth":2880,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*FkzlFyi6qEVEUSeRXs5cIw.png":{"id":"1*FkzlFyi6qEVEUSeRXs5cIw.png","__typename":"ImageMetadata","originalHeight":740,"originalWidth":1400,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*-Ih9cJ-zWRaB9QWvtNo2-Q.png":{"id":"1*-Ih9cJ-zWRaB9QWvtNo2-Q.png","__typename":"ImageMetadata","originalHeight":960,"originalWidth":1280,"focusPercentX":null,"focusPercentY":null,"alt":null},"User:895063a310f4":{"id":"895063a310f4","__typename":"User","name":"Ludovic Benistant"},"NewsletterV3:98cb622434ea":{"id":"98cb622434ea","__typename":"NewsletterV3","slug":"fde5e3dd8903","name":"fde5e3dd8903","description":"","collection":null,"isSubscribed":false,"type":"NEWSLETTER_TYPE_AUTHOR","user":{"__ref":"User:fde5e3dd8903"},"subscribersCount":0},"Tag:machine-learning":{"id":"machine-learning","__typename":"Tag","displayTitle":"Machine Learning","normalizedTagSlug":""},"Tag:artificial-intelligence":{"id":"artificial-intelligence","__typename":"Tag","displayTitle":"Artificial Intelligence","normalizedTagSlug":""},"Tag:towards-data-science":{"id":"towards-data-science","__typename":"Tag","displayTitle":"Towards Data Science","normalizedTagSlug":""},"Tag:mathematics":{"id":"mathematics","__typename":"Tag","displayTitle":"Mathematics","normalizedTagSlug":""},"Tag:code":{"id":"code","__typename":"Tag","displayTitle":"Code","normalizedTagSlug":""},"Post:783029a1f062":{"id":"783029a1f062","__typename":"Post","canonicalUrl":"","collection":{"__ref":"Collection:7f60cf5620c9"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-1-922a2e82e621\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:efb9f427cb40_0"},{"__ref":"Paragraph:efb9f427cb40_1"},{"__ref":"Paragraph:efb9f427cb40_2"},{"__ref":"Paragraph:efb9f427cb40_3"},{"__ref":"Paragraph:efb9f427cb40_4"},{"__ref":"Paragraph:efb9f427cb40_5"},{"__ref":"Paragraph:efb9f427cb40_6"},{"__ref":"Paragraph:efb9f427cb40_7"},{"__ref":"Paragraph:efb9f427cb40_8"},{"__ref":"Paragraph:efb9f427cb40_9"},{"__ref":"Paragraph:efb9f427cb40_10"},{"__ref":"Paragraph:efb9f427cb40_11"},{"__ref":"Paragraph:efb9f427cb40_12"},{"__ref":"Paragraph:efb9f427cb40_13"},{"__ref":"Paragraph:efb9f427cb40_14"},{"__ref":"Paragraph:efb9f427cb40_15"},{"__ref":"Paragraph:efb9f427cb40_16"},{"__ref":"Paragraph:efb9f427cb40_17"},{"__ref":"Paragraph:efb9f427cb40_18"},{"__ref":"Paragraph:efb9f427cb40_19"},{"__ref":"Paragraph:efb9f427cb40_20"},{"__ref":"Paragraph:efb9f427cb40_21"},{"__ref":"Paragraph:efb9f427cb40_22"},{"__ref":"Paragraph:efb9f427cb40_23"},{"__ref":"Paragraph:efb9f427cb40_24"},{"__ref":"Paragraph:efb9f427cb40_25"},{"__ref":"Paragraph:efb9f427cb40_26"},{"__ref":"Paragraph:efb9f427cb40_27"},{"__ref":"Paragraph:efb9f427cb40_28"},{"__ref":"Paragraph:efb9f427cb40_29"},{"__ref":"Paragraph:efb9f427cb40_30"},{"__ref":"Paragraph:efb9f427cb40_31"},{"__ref":"Paragraph:efb9f427cb40_32"},{"__ref":"Paragraph:efb9f427cb40_33"},{"__ref":"Paragraph:efb9f427cb40_34"},{"__ref":"Paragraph:efb9f427cb40_35"},{"__ref":"Paragraph:efb9f427cb40_36"},{"__ref":"Paragraph:efb9f427cb40_37"},{"__ref":"Paragraph:efb9f427cb40_38"},{"__ref":"Paragraph:efb9f427cb40_39"},{"__ref":"Paragraph:efb9f427cb40_40"},{"__ref":"Paragraph:efb9f427cb40_41"},{"__ref":"Paragraph:efb9f427cb40_42"},{"__ref":"Paragraph:efb9f427cb40_43"},{"__ref":"Paragraph:efb9f427cb40_44"},{"__ref":"Paragraph:efb9f427cb40_45"},{"__ref":"Paragraph:efb9f427cb40_46"},{"__ref":"Paragraph:efb9f427cb40_47"},{"__ref":"Paragraph:efb9f427cb40_48"},{"__ref":"Paragraph:efb9f427cb40_49"},{"__ref":"Paragraph:efb9f427cb40_50"},{"__ref":"Paragraph:efb9f427cb40_51"},{"__ref":"Paragraph:efb9f427cb40_52"},{"__ref":"Paragraph:efb9f427cb40_53"},{"__ref":"Paragraph:efb9f427cb40_54"},{"__ref":"Paragraph:efb9f427cb40_55"},{"__ref":"Paragraph:efb9f427cb40_56"},{"__ref":"Paragraph:efb9f427cb40_57"},{"__ref":"Paragraph:efb9f427cb40_58"},{"__ref":"Paragraph:efb9f427cb40_59"},{"__ref":"Paragraph:efb9f427cb40_60"},{"__ref":"Paragraph:efb9f427cb40_61"},{"__ref":"Paragraph:efb9f427cb40_62"},{"__ref":"Paragraph:efb9f427cb40_63"},{"__ref":"Paragraph:efb9f427cb40_64"},{"__ref":"Paragraph:efb9f427cb40_65"},{"__ref":"Paragraph:efb9f427cb40_66"}],"sections":[{"__typename":"Section","name":"c0e7","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"creator":{"__ref":"User:fde5e3dd8903"},"customStyleSheet":{"__ref":"CustomStyleSheet:63d23b36fcaa"},"firstPublishedAt":1598449227741,"isLocked":true,"isPublished":true,"isShortform":false,"layerCake":3,"primaryTopic":{"__ref":"Topic:ae5d4995e225"},"title":"Hands-on guide to Python Optimal Transport toolbox: Part 2","isMarkedPaywallOnly":false,"readCreatorPostsCount":0,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fhands-on-guide-to-python-optimal-transport-toolbox-part-2-783029a1f062","isLimitedState":false,"visibility":"LOCKED","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:machine-learning"},{"__ref":"Tag:artificial-intelligence"},{"__ref":"Tag:towards-data-science"},{"__ref":"Tag:mathematics"},{"__ref":"Tag:code"}],"topics":[{"__typename":"Topic","topicId":"1eca0103fff3","name":"Machine Learning"},{"__typename":"Topic","topicId":"ae5d4995e225","name":"Data Science"},{"__typename":"Topic","topicId":"decb52b64abf","name":"Programming"}],"viewerClapCount":null,"showSubscribeToProfilePromo":false,"showSubscribeToCollectionNewsletterV3Promo":true,"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"","latestPublishedAt":1598451501897,"readingTime":7.687735849056604,"previewContent":{"__typename":"PreviewContent","subtitle":"Color transfer, Image editing and Automatic Translation"},"previewImage":{"__ref":"ImageMetadata:1*DsDDxjH-J4v_Q8tTM1BXtw.png"},"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","clapCount":56,"lockedSource":"LOCKED_POST_SOURCE_UGC","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":1598426753108,"responseDistribution":"NOT_DISTRIBUTED","shareKey":null,"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1598451506659,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":0},"latestPublishedVersion":"efb9f427cb40","isPublishToEmail":false,"readingList":"READING_LIST_NONE","voterCount":6,"recommenders":[]},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"User:c6c44791e380":{"id":"c6c44791e380","__typename":"User","username":"pb.fsu10","name":"Pb Fsu","imageId":"0*NpC-xma00ujUDrfW.jpg","mediumMemberAt":1618923943000,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"pb.fsu10@gmail.com","unverifiedEmail":"","createdAt":1589228549161,"isAuroraVisible":true,"isEligibleToViewNewResponses":true,"isMembershipTrialEligible":true,"isSuspended":false,"styleEditorOnboardingVersionSeen":0,"allowEmailAddressSharingEditorWriter":false,"hasSubdomain":false,"dismissableFlags":[],"hasWebMembershipTrialEnabled":false,"twitterScreenName":"","geolocation":{"__typename":"Geolocation","country":"FR"},"atsQualifiedAt":0}}</script><script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/manifest.80f61e6b.js"></script><script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/6684.26fbab99.js"></script><script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/main.e982b928.js"></script><script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/5573.159bf40f.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/instrumentation.8ea15b6a.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/reporting.be183697.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1752.a348f767.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/2833.383a48e6.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/8342.6aa0b45e.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/4930.d16bc692.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/9692.aa4b76ec.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/4586.06957e16.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/5064.e0fb94df.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/9046.c85ec5d4.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/2846.78dd20ea.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/9990.4f008794.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/7012.1bb4e9a4.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/9972.9b66804a.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/4379.7456fbc7.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/664.f859c4f5.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/8751.cd3413b9.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/2955.70127af4.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/7131.f2494ca5.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/303.49e469f3.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/8127.1c99358b.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/2514.eb9a5ab7.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/6371.e8059cd7.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/8995.d55b9701.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1725.bbc2b8e7.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/3874.32302d9b.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/8953.05fa4432.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/1794.f648e729.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/9454.4276e242.chunk.js"></script>
<script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/Post.aa5fea13.chunk.js"></script><script>window.main();</script><script src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/p.js" async="" id="parsely-cf"></script><iframe src="./Hands-on guide to Python Optimal Transport toolbox_ Part 2 _ by Ievgen Redko _ Towards Data Science_files/a16180790160.html" hidden="" tabindex="-1" title="Optimizely Internal Frame" height="0" width="0" style="display: none;"></iframe></body></html>